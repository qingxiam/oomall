<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商户账户管理系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .container {
            display: flex;
            width: 100vw;
            height: 100vh;
            max-width: 100%;
            max-height: 100%;
        }

        /* 左侧导航栏 */
        .sidebar {
            width: 20%;
            min-width: 180px;
            max-width: 220px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 15px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .back-arrow {
            width: 24px;
            height: 24px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            cursor: pointer;
            font-size: 12px;
        }

        .nav-title {
            font-size: 16px;
            font-weight: bold;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin: 10px 0;
            padding: 10px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-size: 14px;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .nav-item.active {
            background: rgba(255,255,255,0.2);
            font-weight: bold;
        }

        .nav-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            background: rgba(255,255,255,0.8);
            border-radius: 3px;
        }

        /* 主内容区域 */
        .main-content {
            flex: 1;
            background: white;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            flex-shrink: 0;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: #f8f8f8;
            padding: 8px 12px;
            border-radius: 20px;
            border: 1px solid #ddd;
        }

        .search-input {
            border: none;
            background: none;
            outline: none;
            margin-left: 8px;
            width: 160px;
            font-size: 14px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .welcome-text {
            color: #666;
            font-size: 14px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        /* 页面标题 */
        .page-title {
            font-size: 24px;
            color: #333;
            margin-bottom: 8px;
        }

        .page-subtitle {
            display: flex;
            align-items: center;
            color: #666;
            font-size: 14px;
        }

        .subtitle-icon {
            width: 16px;
            height: 16px;
            background: #4CAF50;
            border-radius: 3px;
            margin-right: 8px;
        }

        /* 表单区域 */
        .form-section {
            background: #fafafa;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #eee;
            flex: 1;
        }

        .form-title {
            font-size: 18px;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .form-title-icon {
            width: 20px;
            height: 20px;
            background: #4CAF50;
            border-radius: 4px;
            margin-right: 8px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-weight: bold;
            color: #555;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .form-input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 13px;
            transition: border-color 0.3s ease;
        }

        .form-input, .form-input::placeholder {
            color: #333;
        }

        textarea.form-input {
            resize: vertical;
            min-height: 80px;
        }

        .form-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .form-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
        }

        .btn-secondary {
            background: #f44336;
            color: white;
        }

        .btn-secondary:hover {
            background: #da190b;
        }

        .btn-warning {
            background: #ff9800;
            color: white;
        }

        .btn-warning:hover {
            background: #e68900;
        }


        /* 隐藏页面 */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .detail-card {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 16px;
            margin-top: 15px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .detail-grid.full-width {
            grid-template-columns: 1fr;
        }

        .detail-item {
            background: #f9faf9;
            border: 1px solid #eef2ef;
            border-radius: 6px;
            padding: 10px 12px;
            font-size: 13px;
        }

        .detail-item strong {
            display: block;
            color: #2f5132;
            margin-bottom: 4px;
        }

        .status-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            background: #e8f5e9;
            color: #388e3c;
            margin-left: 8px;
        }

        .history-list {
            list-style: disc;
            margin-left: 20px;
            color: #555;
            line-height: 1.6;
        }

        .info-banner {
            background: #fff8e1;
            border: 1px solid #ffe082;
            border-radius: 6px;
            padding: 12px 16px;
            color: #8d6e63;
            font-size: 13px;
            margin-bottom: 15px;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                min-width: auto;
                max-width: none;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 弹窗样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: white;
            border-radius: 10px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .modal-overlay.show .modal {
            transform: scale(1);
        }

        .modal-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 24px;
            color: white;
        }

        .modal-icon.success {
            background: #4CAF50;
        }

        .modal-icon.warning {
            background: #ff9800;
        }

        .modal-icon.danger {
            background: #f44336;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }

        .modal-message {
            font-size: 16px;
            color: #666;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .modal-btn-primary {
            background: #4CAF50;
            color: white;
        }

        .modal-btn-primary:hover {
            background: #45a049;
        }

        .modal-btn-secondary {
            background: #f5f5f5;
            color: #666;
            border: 1px solid #ddd;
        }

        .modal-btn-secondary:hover {
            background: #e9e9e9;
        }

        /* 登录页面样式 */
        .login-container {
            display: flex;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            align-items: center;
            justify-content: center;
        }

        .login-card {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            text-align: center;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            font-size: 32px;
            color: white;
        }

        .login-title {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .role-selection {
            margin-bottom: 25px;
        }

        .role-label {
            display: block;
            font-weight: bold;
            color: #555;
            margin-bottom: 10px;
            text-align: left;
        }

        .role-dropdown {
            position: relative;
            width: 100%;
        }

        .role-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            padding-right: 40px;
        }

        .role-select:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .role-select:hover {
            border-color: #4CAF50;
        }

        .login-form {
            text-align: left;
        }

        .form-group-login {
            margin-bottom: 20px;
        }

        .form-label-login {
            display: block;
            font-weight: bold;
            color: #555;
            margin-bottom: 8px;
        }

        .form-input-login {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }

        .form-input-login:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .login-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .login-footer {
            margin-top: 20px;
            color: #999;
            font-size: 12px;
        }

        /* 商品管理样式 */
        .product-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 120px;
        }

        .filter-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .filter-select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            background: white;
        }

        .product-search {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }

        .search-input-product {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .search-btn {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .search-btn:hover {
            background: #45a049;
        }

        .product-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .product-table th {
            background: #f8f9fa;
            padding: 12px;
            text-align: left;
            font-weight: bold;
            color: #333;
            border-bottom: 1px solid #ddd;
            font-size: 14px;
        }

        .product-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
            font-size: 13px;
        }

        .product-table tr:hover {
            background: #f8f9fa;
        }

        .product-table tr.selected {
            background: #e8f5e9;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-edit {
            padding: 6px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-edit:hover {
            background: #0056b3;
        }

        .btn-delete {
            padding: 6px 12px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-delete:hover {
            background: #c82333;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 4px;
            font-size: 13px;
        }

        .pagination button:hover {
            background: #f8f9fa;
        }

        .pagination button.active {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .pagination button:disabled {
            background: #f8f9fa;
            color: #999;
            cursor: not-allowed;
        }

        .add-product-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
            transition: all 0.3s ease;
        }

        .add-product-btn:hover {
            background: #45a049;
            transform: scale(1.1);
        }

        /* 针对509mm×286mm比例的优化 */
        @media (min-aspect-ratio: 16/9) {
            .sidebar {
                width: 18%;
                min-width: 160px;
                max-width: 200px;
            }
            
            .main-content {
                padding: 15px;
            }
            
            .form-section {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- 登录页面 -->
    <div id="loginPage" class="login-container">
        <div class="login-card">
            <div class="login-logo">🏪</div>
            <h1 class="login-title">商户管理系统</h1>
            <p class="login-subtitle">请选择您的角色并登录</p>
            
            <div class="role-selection">
                <label class="role-label">选择角色</label>
                <div class="role-dropdown">
                    <select class="role-select" id="roleSelect" onchange="selectRole(this.value)">
                        <option value="">请选择角色</option>
                        <option value="merchant">商户</option>
                        <option value="service-provider">服务商</option>
                        <option value="platform-admin">平台管理人员</option>
                        <option value="technician">维修工</option>
                    </select>
                </div>
            </div>
            
            <form class="login-form" onsubmit="handleLogin(event)">
                <div class="form-group-login">
                    <label class="form-label-login">用户名</label>
                    <input type="text" class="form-input-login" id="username" placeholder="请输入用户名" required>
                </div>
                
                <div class="form-group-login">
                    <label class="form-label-login">密码</label>
                    <input type="password" class="form-input-login" id="password" placeholder="请输入密码" required>
                </div>
                
                <button type="submit" class="login-btn" id="loginBtn" disabled>
                    登录
                </button>
            </form>
            
            <div class="login-footer">
                <p>© 2024 商户管理系统. 保留所有权利.</p>
            </div>
        </div>
    </div>

    <!-- 主应用页面 -->
    <div id="mainApp" class="container" style="display: none;">
        <!-- 左侧导航栏 -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="back-arrow">←</div>
                <div class="nav-title">导航</div>
            </div>
            <ul class="nav-menu">
                <li class="nav-item" onclick="showPage('account-opening')">
                    <div class="nav-icon"></div>
                    商户开户
                </li>
                <li class="nav-item" onclick="showPage('account-info')">
                    <div class="nav-icon"></div>
                    管理账号
                </li>
                <li class="nav-item active" onclick="showPage('products')">
                    <div class="nav-icon"></div>
                    管理商品
                </li>
                <li class="nav-item" onclick="showPage('activities')">
                    <div class="nav-icon"></div>
                    管理活动
                </li>
                <li class="nav-item" onclick="showPage('service-providers')">
                    <div class="nav-icon"></div>
                    管理服务商
                </li>
                <li class="nav-item" onclick="showPage('orders')">
                    <div class="nav-icon"></div>
                    管理订单
                </li>
                <li class="nav-item" onclick="showPage('sales')">
                    <div class="nav-icon"></div>
                    销售情况
                </li>
                <li class="nav-item" onclick="showPage('after-sales')">
                    <div class="nav-icon"></div>
                    管理售后
                </li>
            </ul>
        </div>

        <!-- 主内容区域 -->
        <div class="main-content">
            <!-- 头部 -->
            <div class="header">
                <div class="search-box">
                    <span>🔍</span>
                    <input type="text" id="globalSearchInput" class="search-input" placeholder="输入关键词快速跳转（平台管理员支持：如“审核商户开户”、“封禁顾客”、“建立商品分类”等）">
                </div>
                <div class="user-info">
                    <span class="welcome-text" id="welcomeText">欢迎你! 商户</span>
                    <span>▼</span>
                    <div class="user-avatar" onclick="logout()" title="退出登录">🐧</div>
                </div>
            </div>

            <!-- 页面内容 -->
            <!-- 管理商品主页面 -->
            <div id="products" class="page active">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <h1 class="page-title">管理商品</h1>
                        <div class="page-subtitle">
                            <div class="subtitle-icon"></div>
                            商品管理
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="showPage('apply-new-product')" style="margin: 0;">
                        + 新增商品
                    </button>
                </div>

                <!-- 筛选器 -->
                <div class="product-filters">
                    <div class="filter-group">
                        <label class="filter-label">商品状态</label>
                        <select class="filter-select" id="statusFilter">
                            <option value="">全部状态</option>
                            <option value="approved">已审核</option>
                            <option value="pending">审核中</option>
                            <option value="rejected">未审核</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">商品类别</label>
                        <select class="filter-select" id="categoryFilter">
                            <option value="">全部类别</option>
                            <option value="electronics">电子产品</option>
                            <option value="clothing">服装</option>
                            <option value="food">食品</option>
                            <option value="books">图书</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">价格范围</label>
                        <select class="filter-select" id="priceFilter">
                            <option value="">全部价格</option>
                            <option value="0-100">0-100元</option>
                            <option value="100-500">100-500元</option>
                            <option value="500-1000">500-1000元</option>
                            <option value="1000+">1000元以上</option>
                        </select>
                    </div>
                </div>

                <!-- 搜索框 -->
                <div class="product-search">
                    <input type="text" class="search-input-product" placeholder="输入商品名称或编号" id="productSearchInput">
                    <button class="search-btn" onclick="searchProducts()">搜索</button>
                </div>

                <!-- 商品列表表格 -->
                <table class="product-table">
                    <thead>
                        <tr>
                            <th>商品名称</th>
                            <th>商品编号</th>
                            <th>价格</th>
                            <th>商品类型</th>
                            <th>审核状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="productTableBody">
                        <tr>
                            <td>iPhone 15 Pro</td>
                            <td>P001</td>
                            <td>¥8,999</td>
                            <td>电子产品</td>
                            <td><span class="status-badge status-approved">已审核</span></td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-edit" onclick="showPage('apply-product-change')">变更商品</button>
                                    <button class="btn-edit" onclick="showPage('modify-product-attributes')">修改商品属性</button>
                                    <button class="btn-delete" onclick="deleteProduct('P001')">删除</button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Nike运动鞋</td>
                            <td>P002</td>
                            <td>¥599</td>
                            <td>服装</td>
                            <td><span class="status-badge status-pending">审核中</span></td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-edit" onclick="showPage('apply-product-change')">变更商品</button>
                                    <button class="btn-edit" onclick="showPage('modify-product-attributes')">修改商品属性</button>
                                    <button class="btn-delete" onclick="deleteProduct('P002')">删除</button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>有机苹果</td>
                            <td>P003</td>
                            <td>¥29.9</td>
                            <td>食品</td>
                            <td><span class="status-badge status-rejected">未审核</span></td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-edit" onclick="showPage('apply-product-change')">变更商品</button>
                                    <button class="btn-edit" onclick="showPage('modify-product-attributes')">修改商品属性</button>
                                    <button class="btn-delete" onclick="deleteProduct('P003')">删除</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <!-- 分页 -->
                <div class="pagination">
                    <button onclick="changePage(-1)" disabled>上一页</button>
                    <button class="active">1</button>
                    <button onclick="changePage(1)">2</button>
                    <button onclick="changePage(1)">3</button>
                    <button onclick="changePage(1)">下一页</button>
                </div>

            </div>

            <!-- 商品搜索结果页面 -->
            <div id="product-search-results" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <h1 class="page-title">管理商品</h1>
                        <div class="page-subtitle">
                            <div class="subtitle-icon"></div>
                            商品管理
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="showPage('apply-new-product')" style="margin: 0;">
                        + 新增商品
                    </button>
                </div>

                <!-- 筛选器 -->
                <div class="product-filters">
                    <div class="filter-group">
                        <label class="filter-label">商品状态</label>
                        <select class="filter-select" id="searchStatusFilter">
                            <option value="approved">审核通过</option>
                            <option value="pending">审核中</option>
                            <option value="rejected">未审核</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">商品类别</label>
                        <select class="filter-select" id="searchCategoryFilter">
                            <option value="food">食品</option>
                            <option value="electronics">电子产品</option>
                            <option value="clothing">服装</option>
                            <option value="books">图书</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">价格</label>
                        <select class="filter-select" id="searchPriceFilter">
                            <option value="desc">降序</option>
                            <option value="asc">升序</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <button class="search-btn" style="margin-top: 20px;">筛选</button>
                    </div>
                </div>

                <!-- 搜索结果搜索框 -->
                <div class="product-search" style="margin-bottom: 20px;">
                    <input type="text" class="search-input-product" placeholder="厦门" id="searchResultsInput" value="厦门">
                    <button class="search-btn" onclick="searchProductsFromResults()">搜索</button>
                </div>

                <!-- 返回按钮和搜索结果信息 -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <button class="btn btn-secondary" onclick="showPage('products')" style="margin: 0; padding: 8px 16px; font-size: 13px;">
                        ← 返回商品列表
                    </button>
                    <div style="color: #666; font-size: 14px;">
                        已为您找到一种商品:
                    </div>
                </div>

                <!-- 搜索结果表格 -->
                <table class="product-table">
                    <thead>
                        <tr>
                            <th>商品名称</th>
                            <th>编号</th>
                            <th>价格(CNY)</th>
                            <th>商品类型</th>
                            <th>审核状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 40px; height: 40px; background: #ff6b6b; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px;">🍅</div>
                                    <span>厦门西红柿</span>
                                </div>
                            </td>
                            <td>600123</td>
                            <td>100.00</td>
                            <td>食品</td>
                            <td><span class="status-badge status-approved">已通过</span></td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-edit" onclick="showPage('apply-product-change')">变更商品</button>
                                    <button class="btn-edit" onclick="showPage('modify-product-attributes')">修改商品属性</button>
                                    <button class="btn-delete" onclick="deleteProduct('600123')">删除</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <!-- 分页 -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                    <div style="display: flex; align-items: center; gap: 10px; color: #666; font-size: 14px;">
                        <span>显示结果:</span>
                        <select style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option>1</option>
                            <option>10</option>
                            <option>20</option>
                            <option>50</option>
                        </select>
                    </div>
                    <div class="pagination">
                        <button disabled>←</button>
                        <button class="active">1</button>
                        <button>→</button>
                    </div>
                </div>
            </div>

            <div id="account-info" class="page">
                <h1 class="page-title">账户信息</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    管理账号
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        账户信息
                    </h2>
                    <div class="form-grid">
                        <!-- 左列 -->
                        <div class="form-group">
                            <label class="form-label">商户名称</label>
                            <input type="text" class="form-input" value="豪客来商店">
                        </div>
                        <div class="form-group">
                            <label class="form-label">商品数量上限 (件)</label>
                            <input type="number" class="form-input" value="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">员工数量上限 (人)</label>
                            <input type="number" class="form-input" value="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">免邮门槛</label>
                            <input type="text" class="form-input" value="20(CNY)">
                        </div>
                        
                        <!-- 右列 -->
                        <div class="form-group">
                            <label class="form-label">法人姓名</label>
                            <input type="text" class="form-input" value="张三">
                        </div>
                        <div class="form-group">
                            <label class="form-label">商户地址</label>
                            <input type="text" class="form-input" value="福建省厦门市翔安区">
                        </div>
                        <div class="form-group">
                            <label class="form-label">联系电话</label>
                            <input type="tel" class="form-input" value="123456789">
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="showPage('modify-account')">修改账户信息</button>
                        <button class="btn btn-primary" onclick="showPage('modify-attributes')">修改账户属性</button>
                    </div>
                </div>


                <div class="form-buttons" style="margin-top: 30px; justify-content: flex-end;">
                    <button class="btn btn-warning" onclick="showPage('suspend-account')">暂停账户</button>
                    <button class="btn btn-secondary" onclick="showPage('cancel-account')">注销账户</button>
                </div>
            </div>

            <!-- 开户页面 (MALL-SHOP-001) -->
            <div id="account-opening" class="page">
                <h1 class="page-title">商户开户申请</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    创建新商户账户
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        开户申请信息
                    </h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">商户名称 *</label>
                            <input type="text" class="form-input" placeholder="请输入商户名称" id="merchantName">
                        </div>
                        <div class="form-group">
                            <label class="form-label">联系人姓名 *</label>
                            <input type="text" class="form-input" placeholder="请输入联系人姓名" id="contactName">
                        </div>
                        <div class="form-group">
                            <label class="form-label">联系电话 *</label>
                            <input type="tel" class="form-input" placeholder="请输入联系电话" id="contactPhone">
                        </div>
                        <div class="form-group">
                            <label class="form-label">商户地址 *</label>
                            <input type="text" class="form-input" placeholder="请输入商户地址" id="merchantAddress">
                        </div>
                        <div class="form-group">
                            <label class="form-label">商品数目上限 *</label>
                            <input type="number" class="form-input" placeholder="请输入商品数目上限" id="productLimit">
                        </div>
                        <div class="form-group">
                            <label class="form-label">商户员工上限 *</label>
                            <input type="number" class="form-input" placeholder="请输入商户员工上限" id="employeeLimit">
                        </div>
                    </div>
                    
                    <!-- 重要提示 -->
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 6px; border: 1px solid #bbdefb; margin: 20px 0;">
                        <p style="color: #1976d2; margin: 0; font-size: 14px;">
                            <strong>📋 重要提示：</strong>用户开户前需先注册系统用户，请确保您已完成系统用户注册。
                        </p>
                    </div>
                    
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="submitAccountOpening()">提交开户申请</button>
                        <button class="btn btn-secondary" onclick="showPage('account-info')">取消</button>
                    </div>
                </div>
            </div>

            <!-- 申请新增商品页面 (MALL-PRODUCT-004) -->
            <div id="apply-new-product" class="page">
                <h1 class="page-title">申请新增商品</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    新增商品申请
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        商品基本信息
                    </h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">商品分类 *</label>
                            <select class="form-input" id="productCategory">
                                <option value="">请选择商品分类</option>
                                <option value="electronics">电子产品</option>
                                <option value="clothing">服装</option>
                                <option value="food">食品</option>
                                <option value="books">图书</option>
                                <option value="home">家居用品</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">商品名称 *</label>
                            <input type="text" class="form-input" id="productName" placeholder="请输入商品名称">
                        </div>
                        <div class="form-group">
                            <label class="form-label">原价 *</label>
                            <input type="number" class="form-input" id="originalPrice" placeholder="请输入原价">
                        </div>
                        <div class="form-group">
                            <label class="form-label">单位 *</label>
                            <input type="text" class="form-input" id="unit" placeholder="请输入单位">
                        </div>
                        <div class="form-group">
                            <label class="form-label">产地 *</label>
                            <input type="text" class="form-input" id="origin" placeholder="请输入产地">
                        </div>
                        <div class="form-group">
                            <label class="form-label">条码 *</label>
                            <input type="text" class="form-input" id="barcode" placeholder="请输入条码">
                        </div>
                        <div class="form-group">
                            <label class="form-label">分账比例 *</label>
                            <input type="number" class="form-input" id="revenueShareRatio" placeholder="请输入分账比例(%)" min="0" max="100">
                        </div>
                    </div>
                    
                    <!-- 商品类型选择 -->
                    <div style="margin: 20px 0;">
                        <label class="form-label">商品类型</label>
                        <div style="display: flex; gap: 20px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="radio" name="productType" value="normal" checked onchange="toggleBundleOptions(false)">
                                普通商品
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="radio" name="productType" value="bundle" onchange="toggleBundleOptions(true)">
                                捆绑商品
                            </label>
                        </div>
                    </div>

                    <!-- 捆绑商品选项 -->
                    <div id="bundleOptions" style="display: none; margin: 20px 0;">
                        <h3 style="color: #333; margin-bottom: 15px;">捆绑商品配置</h3>
                        <div class="form-group">
                            <label class="form-label">选择商品</label>
                            <select class="form-input" id="bundleProductSelect" multiple style="height: 120px;">
                                <option value="P001">iPhone 15 Pro</option>
                                <option value="P002">Nike运动鞋</option>
                                <option value="P003">有机苹果</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">捆绑中每个商品数量</label>
                            <input type="text" class="form-input" id="bundleQuantities" placeholder="例如：2,1,3">
                        </div>
                        <div class="form-group">
                            <label class="form-label">捆绑中商品间分账比例</label>
                            <input type="text" class="form-input" id="bundleShareRatios" placeholder="例如：50,30,20">
                        </div>
                    </div>
                    
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="submitNewProduct()">提交申请</button>
                        <button class="btn btn-secondary" onclick="showPage('products')">取消</button>
                    </div>
                </div>
            </div>

            <!-- 销户页面 (MALL-SHOP-002) -->
            <div id="account-cancellation" class="page">
                <h1 class="page-title">账户注销申请</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    注销商户账户
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        注销申请信息
                    </h2>
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label class="form-label">注销原因 *</label>
                            <textarea class="form-input" rows="4" placeholder="请详细说明注销原因"></textarea>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">确认信息</label>
                            <div style="background: #fff3cd; padding: 15px; border-radius: 6px; border: 1px solid #ffeaa7;">
                                <p style="color: #856404; margin-bottom: 10px;"><strong>⚠️ 重要提醒：</strong></p>
                                <ul style="color: #856404; margin-left: 20px;">
                                    <li>注销后账户将无法恢复</li>
                                    <li>请确保所有订单分账已完成</li>
                                    <li>请确保已处理完所有售后问题</li>
                                    <li>请确保已备份重要数据</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button class="btn btn-secondary" onclick="submitAccountCancellation()">提交注销申请</button>
                        <button class="btn btn-primary" onclick="showPage('account-info')">取消</button>
                    </div>
                </div>
            </div>

            <!-- 申请变更商品页面 (MALL-PRODUCT-005) -->
            <div id="apply-product-change" class="page">
                <h1 class="page-title">申请变更商品</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    商品变更申请
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        选择要变更的商品
                    </h2>
                    <div class="form-group">
                        <label class="form-label">已审核通过的商品 *</label>
                        <select class="form-input" id="changeProductSelect">
                            <option value="">请选择要变更的商品</option>
                            <option value="P001">iPhone 15 Pro - 电子产品</option>
                            <option value="P002">Nike运动鞋 - 服装</option>
                        </select>
                    </div>
                    
                    <h2 class="form-title" style="margin-top: 30px;">
                        <div class="form-title-icon"></div>
                        变更商品信息
                    </h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">商品分类</label>
                            <select class="form-input" id="changeProductCategory">
                                <option value="">请选择商品分类</option>
                                <option value="electronics">电子产品</option>
                                <option value="clothing">服装</option>
                                <option value="food">食品</option>
                                <option value="books">图书</option>
                                <option value="home">家居用品</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">商品名称</label>
                            <input type="text" class="form-input" id="changeProductName" placeholder="请输入商品名称">
                        </div>
                        <div class="form-group">
                            <label class="form-label">原价</label>
                            <input type="number" class="form-input" id="changeOriginalPrice" placeholder="请输入原价">
                        </div>
                        <div class="form-group">
                            <label class="form-label">单位</label>
                            <input type="text" class="form-input" id="changeUnit" placeholder="请输入单位">
                        </div>
                        <div class="form-group">
                            <label class="form-label">产地</label>
                            <input type="text" class="form-input" id="changeOrigin" placeholder="请输入产地">
                        </div>
                        <div class="form-group">
                            <label class="form-label">条码</label>
                            <input type="text" class="form-input" id="changeBarcode" placeholder="请输入条码">
                        </div>
                        <div class="form-group">
                            <label class="form-label">分账比例</label>
                            <input type="number" class="form-input" id="changeRevenueShareRatio" placeholder="请输入分账比例(%)" min="0" max="100">
                        </div>
                    </div>
                    
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="submitProductChange()">提交变更申请</button>
                        <button class="btn btn-secondary" onclick="showPage('products')">取消</button>
                    </div>
                </div>
            </div>

            <!-- 查询商品页面 (MALL-PRODUCT-006) -->
            <div id="query-product" class="page">
                <h1 class="page-title">查询商品</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    商品查询
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        查询条件
                    </h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">商品名称</label>
                            <input type="text" class="form-input" id="queryProductName" placeholder="请输入商品名称">
                        </div>
                        <div class="form-group">
                            <label class="form-label">条码</label>
                            <input type="text" class="form-input" id="queryBarcode" placeholder="请输入条码">
                        </div>
                    </div>
                    
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="queryProducts()">查询商品</button>
                        <button class="btn btn-secondary" onclick="showPage('products')">返回</button>
                    </div>
                    
                    <!-- 查询结果 -->
                    <div id="queryResults" style="margin-top: 30px; display: none;">
                        <h2 class="form-title">
                            <div class="form-title-icon"></div>
                            查询结果
                        </h2>
                        <table class="product-table">
                            <thead>
                                <tr>
                                    <th>商品名称</th>
                                    <th>商品分类</th>
                                    <th>原价</th>
                                    <th>单位</th>
                                    <th>产地</th>
                                    <th>条码</th>
                                    <th>分账比例</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="queryResultsBody">
                                <!-- 查询结果将在这里显示 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- 修改商品属性页面 (MALL-PRODUCT-007) -->
            <div id="modify-product-attributes" class="page">
                <h1 class="page-title">修改商品属性</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    商品属性修改
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        选择要修改的商品
                    </h2>
                    <div class="form-group">
                        <label class="form-label">已审核通过的商品 *</label>
                        <select class="form-input" id="modifyProductSelect">
                            <option value="">请选择要修改的商品</option>
                            <option value="P001">iPhone 15 Pro - 电子产品</option>
                            <option value="P002">Nike运动鞋 - 服装</option>
                        </select>
                    </div>
                    
                    <h2 class="form-title" style="margin-top: 30px;">
                        <div class="form-title-icon"></div>
                        修改商品属性
                    </h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">相关商品</label>
                            <input type="text" class="form-input" id="relatedProducts" placeholder="请输入相关商品">
                        </div>
                        <div class="form-group">
                            <label class="form-label">运费计算方法</label>
                            <select class="form-input" id="shippingMethod">
                                <option value="">请选择运费计算方法</option>
                                <option value="fixed">固定运费</option>
                                <option value="weight">按重量计算</option>
                                <option value="price">按价格计算</option>
                                <option value="free">免运费</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">配送物流</label>
                            <input type="text" class="form-input" id="deliveryLogistics" placeholder="请输入配送物流">
                        </div>
                        <div class="form-group">
                            <label class="form-label">商品重量(kg)</label>
                            <input type="number" class="form-input" id="productWeight" placeholder="请输入商品重量" step="0.1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">SKU</label>
                            <input type="text" class="form-input" id="productSku" placeholder="请输入SKU">
                        </div>
                    </div>
                    
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="submitProductAttributes()">提交修改</button>
                        <button class="btn btn-secondary" onclick="showPage('products')">取消</button>
                    </div>
                </div>
            </div>

            <!-- 修改账户页面 (MALL-SHOP-003) -->
            <div id="modify-account" class="page">
                <h1 class="page-title">修改账户信息</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    修改商户基本信息
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        账户信息修改
                    </h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">商户名称 *</label>
                            <input type="text" class="form-input" value="豪客来商店">
                        </div>
                        <div class="form-group">
                            <label class="form-label">商品数目上限 *</label>
                            <input type="number" class="form-input" value="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">商户员工上限 *</label>
                            <input type="number" class="form-input" value="100">
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">修改说明</label>
                            <textarea class="form-input" rows="3" placeholder="请说明修改原因"></textarea>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="submitAccountModification()">提交修改申请</button>
                        <button class="btn btn-secondary" onclick="showPage('account-info')">取消</button>
                    </div>
                </div>
            </div>

            <!-- 修改账户属性页面 (MALL-SHOP-004) -->
            <div id="modify-attributes" class="page">
                <h1 class="page-title">修改账户属性</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    修改商户属性信息
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        账户属性修改
                    </h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">联系人姓名 *</label>
                            <input type="text" class="form-input" value="张三">
                        </div>
                        <div class="form-group">
                            <label class="form-label">联系人电话 *</label>
                            <input type="tel" class="form-input" value="123456789">
                        </div>
                        <div class="form-group">
                            <label class="form-label">联系人地址 *</label>
                            <input type="text" class="form-input" value="福建省厦门市翔安区">
                        </div>
                        <div class="form-group">
                            <label class="form-label">免邮门槛 *</label>
                            <input type="text" class="form-input" value="20(CNY)">
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">修改说明</label>
                            <textarea class="form-input" rows="3" placeholder="请说明修改原因"></textarea>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="submitAttributeModification()">提交属性修改</button>
                        <button class="btn btn-secondary" onclick="showPage('account-info')">取消</button>
                    </div>
                </div>
            </div>

            <!-- 暂停账户页面 -->
            <div id="suspend-account" class="page">
                <h1 class="page-title">暂停账户</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    暂停商户账户
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        暂停账户申请
                    </h2>
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label class="form-label">暂停原因 *</label>
                            <textarea class="form-input" rows="4" placeholder="请详细说明暂停账户的原因"></textarea>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">暂停期限</label>
                            <select class="form-input">
                                <option value="1">1个月</option>
                                <option value="3">3个月</option>
                                <option value="6">6个月</option>
                                <option value="12">12个月</option>
                                <option value="indefinite">无限期</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button class="btn btn-warning" onclick="submitAccountSuspension()">提交暂停申请</button>
                        <button class="btn btn-secondary" onclick="showPage('account-info')">取消</button>
                    </div>
                </div>
            </div>

            <!-- 注销账户页面 -->
            <div id="cancel-account" class="page">
                <h1 class="page-title">注销账户</h1>
                <div class="page-subtitle">
                    <div class="subtitle-icon"></div>
                    注销商户账户
                </div>

                <div class="form-section">
                    <h2 class="form-title">
                        <div class="form-title-icon"></div>
                        注销确认
                    </h2>
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label class="form-label">注销原因 *</label>
                            <textarea class="form-input" rows="4" placeholder="请详细说明注销原因"></textarea>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">确认信息</label>
                            <div style="background: #f8d7da; padding: 15px; border-radius: 6px; border: 1px solid #f5c6cb;">
                                <p style="color: #721c24; margin-bottom: 10px;"><strong>⚠️ 危险操作：</strong></p>
                                <ul style="color: #721c24; margin-left: 20px;">
                                    <li>此操作不可逆，账户将被永久删除</li>
                                    <li>所有相关数据将被清除</li>
                                    <li>请确保已备份重要信息</li>
                                    <li>请确保所有业务已妥善处理</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button class="btn btn-secondary" onclick="submitAccountCancellation()">确认注销</button>
                        <button class="btn btn-primary" onclick="showPage('account-info')">取消</button>
                    </div>
                </div>
            </div>

            <!-- ===================== 平台管理员：主导航页面 ===================== -->
            <!-- 管理商户（主页面：列出对应用例按钮） -->
            <div id="admin-merchants" class="page">
                <h1 class="page-title">平台管理员 · 管理商户</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>选择要执行的用例</div>
                <div class="form-section">
                    <div class="form-buttons" style="flex-wrap: wrap; gap: 10px;">
                        <button class="btn btn-primary" onclick="showPage('admin-merchant-approve-open')">审核商户开户</button>
                        <button class="btn btn-primary" onclick="showPage('admin-merchant-approve-change')">审核商户变更</button>
                        <button class="btn btn-warning" onclick="showPage('admin-merchant-suspend')">暂停商户</button>
                        <button class="btn btn-primary" onclick="showPage('admin-merchant-resume')">恢复商户</button>
                    </div>
                </div>
            </div>

            <!-- 管理商品（主页面：列出对应用例按钮） -->
            <div id="admin-products" class="page">
                <h1 class="page-title">平台管理员 · 管理商品</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>选择要执行的用例</div>
                <div class="form-section">
                    <div class="form-buttons" style="flex-wrap: wrap; gap: 10px;">
                        <button class="btn btn-primary" onclick="showPage('admin-product-approve-new')">审核新增商品</button>
                        <button class="btn btn-primary" onclick="showPage('admin-product-approve-change')">审核变更商品</button>
                        <button class="btn btn-primary" onclick="showPage('admin-product-category-create')">建立商品分类</button>
                        <button class="btn btn-secondary" onclick="showPage('admin-product-category-delete')">删除商品分类</button>
                        <button class="btn btn-warning" onclick="showPage('admin-product-category-update')">修改商品分类</button>
                        <button class="btn btn-primary" onclick="showPage('admin-product-query')">查询商品</button>
                    </div>
                </div>
            </div>

            <!-- 管理顾客（主页面） -->
            <div id="admin-customers" class="page">
                <h1 class="page-title">平台管理员 · 管理顾客</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>选择要执行的用例</div>
                <div class="form-section">
                    <div class="form-buttons" style="flex-wrap: wrap; gap: 10px;">
                        <button class="btn btn-warning" onclick="showPage('admin-customer-ban')">封禁顾客</button>
                        <button class="btn btn-primary" onclick="showPage('admin-customer-unban')">解禁顾客</button>
                        <button class="btn btn-primary" onclick="showPage('admin-customer-query')">查询顾客</button>
                        <button class="btn btn-secondary" onclick="showPage('admin-customer-deactivate')">注销顾客</button>
                    </div>
                </div>
            </div>

            <!-- 管理服务商（主页面） -->
            <div id="admin-providers" class="page">
                <h1 class="page-title">平台管理员 · 管理服务商</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>选择要执行的用例</div>
                <div class="form-section">
                    <div class="form-buttons" style="flex-wrap: wrap; gap: 10px;">
                        <button class="btn btn-primary" onclick="showPage('admin-provider-approve-open')">审核服务商开户</button>
                        <button class="btn btn-primary" onclick="showPage('admin-provider-approve-change')">审核服务商变更</button>
                        <button class="btn btn-primary" onclick="showPage('admin-provider-query')">查询服务商</button>
                        <button class="btn btn-warning" onclick="showPage('admin-provider-suspend')">暂停服务商</button>
                        <button class="btn btn-primary" onclick="showPage('admin-provider-resume')">恢复服务商</button>
                    </div>
                </div>
            </div>

            <!-- 管理活动（主页面） -->
            <div id="admin-activities" class="page">
                <h1 class="page-title">平台管理员 · 管理活动</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>选择要执行的用例</div>
                <div class="form-section">
                    <div class="form-buttons" style="flex-wrap: wrap; gap: 10px;">
                        <button class="btn btn-primary" onclick="showPage('admin-activity-approve')">审核活动</button>
                        <button class="btn btn-primary" onclick="showPage('admin-activity-query')">查询活动</button>
                    </div>
                </div>
            </div>

            <!-- ===================== 平台管理员：商户子页面 ===================== -->
            <div id="admin-merchant-approve-open" class="page">
                <h1 class="page-title">审核商户开户</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>核对平台提交的开户资料并给出审核结论</div>
                <div class="form-section">
                    <div class="info-banner">从列表中选择一条申请加载完整资料，确认后在下方执行“审核通过”或“驳回并记录原因”。</div>
                    <table class="product-table" id="merchantOpenTable">
                        <thead>
                            <tr>
                                <th>申请编号</th>
                                <th>商户名称</th>
                                <th>联系人</th>
                                <th>联系电话</th>
                                <th>提交时间</th>
                                <th>查看</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-id="AO-2025001">
                                <td>AO-2025001</td>
                                <td>示例商户A</td>
                                <td>张三</td>
                                <td>13000000001</td>
                                <td>2025-10-20 09:30</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectMerchantOpen('AO-2025001')">查看详情</button></td>
                            </tr>
                            <tr data-id="AO-2025002">
                                <td>AO-2025002</td>
                                <td>示例商户B</td>
                                <td>李四</td>
                                <td>13000000002</td>
                                <td>2025-10-21 11:05</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectMerchantOpen('AO-2025002')">查看详情</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <div id="merchantOpenDetail" class="detail-card">
                        <h2 class="form-title"><div class="form-title-icon"></div>申请详情 <span class="status-tag">待审核</span></h2>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>申请编号</strong><span id="merchantOpenCurrentId">请选择申请</span></div>
                            <div class="detail-item"><strong>商户名称</strong><span id="merchantOpenName">-</span></div>
                            <div class="detail-item"><strong>联系人</strong><span id="merchantOpenContact">-</span></div>
                            <div class="detail-item"><strong>联系电话</strong><span id="merchantOpenPhone">-</span></div>
                            <div class="detail-item"><strong>经营范围</strong><span id="merchantOpenScope">-</span></div>
                            <div class="detail-item"><strong>所在地区</strong><span id="merchantOpenRegion">-</span></div>
                            <div class="detail-item"><strong>注册地址</strong><span id="merchantOpenAddress">-</span></div>
                            <div class="detail-item"><strong>分账比例分类</strong><span id="merchantOpenShare">-</span></div>
                        </div>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>营业执照编号</strong><span id="merchantOpenLicense">-</span></div>
                            <div class="detail-item"><strong>执照有效期</strong><span id="merchantOpenLicenseValid">-</span></div>
                            <div class="detail-item"><strong>开户银行信息</strong><span id="merchantOpenBank">-</span></div>
                            <div class="detail-item"><strong>提交时间</strong><span id="merchantOpenSubmit">-</span></div>
                        </div>
                        <div class="detail-grid full-width">
                            <div class="detail-item">
                                <strong>资质附件</strong>
                                <ul class="history-list" id="merchantOpenAttachments"><li>未选择申请</li></ul>
                            </div>
                            <div class="detail-item">
                                <strong>备注</strong>
                                <span id="merchantOpenRemark">-</span>
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">驳回原因（必填）</label>
                            <textarea id="merchantOpenRejectReason" class="form-input" placeholder="若驳回，请写明不通过的原因和整改建议"></textarea>
                        </div>
                        <div class="form-buttons">
                            <button class="btn btn-primary" onclick="submitMerchantOpenDecision('approved')">审核通过</button>
                            <button class="btn btn-secondary" onclick="submitMerchantOpenDecision('rejected')">驳回并记录原因</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="admin-merchant-approve-change" class="page">
                <h1 class="page-title">审核商户变更</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>核对商户提交的变更材料并确认是否生效</div>
                <div class="form-section">
                    <div class="info-banner">变更项可能包含联系人、经营范围、地址等信息。审核前务必逐项核对，驳回时写明不通过原因。</div>
                    <table class="product-table" id="merchantChangeTable">
                        <thead>
                            <tr>
                                <th>变更编号</th>
                                <th>商户名称</th>
                                <th>提交时间</th>
                                <th>主要变更项</th>
                                <th>查看</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-id="MC-1001">
                                <td>MC-1001</td>
                                <td>示例商户A</td>
                                <td>2025-10-18 14:22</td>
                                <td>注册地址、联系人</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectMerchantChange('MC-1001')">查看详情</button></td>
                            </tr>
                            <tr data-id="MC-1002">
                                <td>MC-1002</td>
                                <td>示例商户B</td>
                                <td>2025-10-19 10:06</td>
                                <td>经营范围</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectMerchantChange('MC-1002')">查看详情</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <div id="merchantChangeDetail" class="detail-card">
                        <h2 class="form-title"><div class="form-title-icon"></div>变更详情 <span class="status-tag">待审核</span></h2>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>变更编号</strong><span id="merchantChangeCurrentId">请选择变更申请</span></div>
                            <div class="detail-item"><strong>商户名称</strong><span id="merchantChangeName">-</span></div>
                            <div class="detail-item"><strong>联系人</strong><span id="merchantChangeContact">-</span></div>
                            <div class="detail-item"><strong>联系电话</strong><span id="merchantChangePhone">-</span></div>
                            <div class="detail-item"><strong>提交时间</strong><span id="merchantChangeSubmit">-</span></div>
                            <div class="detail-item"><strong>附件</strong><span id="merchantChangeAttachments">-</span></div>
                        </div>
                        <div class="detail-item" style="margin-top:12px;">
                            <strong>变更内容比对</strong>
                            <ul class="history-list" id="merchantChangeDiff"><li>未选择申请</li></ul>
                        </div>
                        <div class="form-group full-width" style="margin-top:15px;">
                            <label class="form-label">驳回原因（必填）</label>
                            <textarea id="merchantChangeRejectReason" class="form-input" placeholder="若不通过，请写明需要补充或修正的材料"></textarea>
                        </div>
                        <div class="form-buttons">
                            <button class="btn btn-primary" onclick="submitMerchantChangeDecision('approved')">审核通过</button>
                            <button class="btn btn-secondary" onclick="submitMerchantChangeDecision('rejected')">驳回并记录原因</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="admin-merchant-suspend" class="page">
                <h1 class="page-title">暂停商户</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>根据商户名称、联系电话、状态检索后执行暂停</div>
                <div class="form-section">
                    <div class="info-banner">暂停后该商户所有商品将被停止销售，且在解除前无法提交新增或变更商品申请，售后流程保持正常。</div>
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">商户名称</label><input id="suspendMerchantName" class="form-input" placeholder="支持模糊匹配"/></div>
                        <div class="form-group"><label class="form-label">联系电话</label><input id="suspendMerchantPhone" class="form-input" placeholder="例如 1300000xxxx"/></div>
                        <div class="form-group"><label class="form-label">商户状态</label>
                            <select id="suspendMerchantStatus" class="form-input">
                                <option value="active">在营</option>
                                <option value="audit">待审核</option>
                                <option value="all">全部</option>
                            </select>
                        </div>
                        <div class="form-group"><label class="form-label">所属地区</label><input id="suspendMerchantRegion" class="form-input" placeholder="省/市"/></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-warning" onclick="searchMerchantList('suspend')">检索商户</button></div>

                    <h2 class="form-title" style="margin-top:20px;"><div class="form-title-icon"></div>检索结果</h2>
                    <table class="product-table" id="merchantSuspendResult">
                        <thead>
                            <tr>
                                <th>商户名称</th>
                                <th>联系人</th>
                                <th>联系电话</th>
                                <th>省/市/区</th>
                                <th>详细地址</th>
                                <th>状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="7" style="text-align:center; color:#777;">请先输入查询条件后点击“检索商户”</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="admin-merchant-resume" class="page">
                <h1 class="page-title">恢复商户</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>按条件查找暂停商户并恢复营业</div>
                <div class="form-section">
                    <div class="info-banner">恢复后该商户的商品将自动恢复销售，原有审核权限同步恢复。</div>
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">商户名称</label><input id="resumeMerchantName" class="form-input" placeholder="支持模糊匹配"/></div>
                        <div class="form-group"><label class="form-label">联系电话</label><input id="resumeMerchantPhone" class="form-input" placeholder="例如 1300000xxxx"/></div>
                        <div class="form-group"><label class="form-label">状态筛选</label>
                            <select id="resumeMerchantStatus" class="form-input">
                                <option value="suspended">暂停</option>
                                <option value="all">全部</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchMerchantList('resume')">检索暂停商户</button></div>

                    <h2 class="form-title" style="margin-top:20px;"><div class="form-title-icon"></div>检索结果</h2>
                    <table class="product-table" id="merchantResumeResult">
                        <thead>
                            <tr>
                                <th>商户名称</th>
                                <th>联系人</th>
                                <th>联系电话</th>
                                <th>省/市/区</th>
                                <th>详细地址</th>
                                <th>当前状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="7" style="text-align:center; color:#777;">请先检索暂停商户</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ===================== 平台管理员：商品子页面 ===================== -->
            <div id="admin-product-approve-new" class="page">
                <h1 class="page-title">审核新增商品</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>核对新增商品的全部属性、分账比例及定价信息</div>
                <div class="form-section">
                <div class="info-banner">选择商品后对照申请材料，确认分类、定价、条码、分账比例等信息是否符合平台标准。驳回时需填写原因。</div>
                <table class="product-table" id="productNewTable">
                    <thead>
                        <tr>
                            <th>申请编号</th>
                            <th>商品名称</th>
                            <th>商铺名称</th>
                            <th>提交时间</th>
                            <th>查看</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-id="NP-5001">
                            <td>NP-5001</td>
                            <td>智能手表 X</td>
                            <td>示例商户A</td>
                            <td>2025-10-20 10:12</td>
                            <td class="action-buttons"><button class="btn-edit" onclick="selectProductNew('NP-5001')">查看详情</button></td>
                        </tr>
                        <tr data-id="NP-5002">
                            <td>NP-5002</td>
                            <td>有机咖啡豆</td>
                            <td>示例商户B</td>
                            <td>2025-10-21 08:55</td>
                            <td class="action-buttons"><button class="btn-edit" onclick="selectProductNew('NP-5002')">查看详情</button></td>
                        </tr>
                    </tbody>
                </table>

                <div id="productNewDetail" class="detail-card">
                    <h2 class="form-title"><div class="form-title-icon"></div>商品申请详情 <span class="status-tag">待审核</span></h2>
                    <div class="detail-grid">
                        <div class="detail-item"><strong>申请编号</strong><span id="productNewCurrentId">请选择商品</span></div>
                        <div class="detail-item"><strong>商品名称</strong><span id="productNewName">-</span></div>
                        <div class="detail-item"><strong>所属商铺</strong><span id="productNewShop">-</span></div>
                        <div class="detail-item"><strong>所属分类</strong><span id="productNewCategory">-</span></div>
                        <div class="detail-item"><strong>原价</strong><span id="productNewOriginal">-</span></div>
                        <div class="detail-item"><strong>销售价格</strong><span id="productNewPrice">-</span></div>
                        <div class="detail-item"><strong>单位</strong><span id="productNewUnit">-</span></div>
                        <div class="detail-item"><strong>产地</strong><span id="productNewOrigin">-</span></div>
                        <div class="detail-item"><strong>条码</strong><span id="productNewBarcode">-</span></div>
                        <div class="detail-item"><strong>分账比例</strong><span id="productNewShare">-</span></div>
                    </div>
                    <div class="detail-grid full-width">
                        <div class="detail-item">
                            <strong>分账比例分类</strong>
                            <span id="productNewShareCategory">-</span>
                        </div>
                        <div class="detail-item">
                            <strong>提交时间</strong>
                            <span id="productNewSubmit">-</span>
                        </div>
                    </div>
                    <div class="detail-grid full-width">
                        <div class="detail-item">
                            <strong>资料附件</strong>
                            <ul class="history-list" id="productNewAttachments"><li>未选择商品</li></ul>
                        </div>
                        <div class="detail-item">
                            <strong>平台备注</strong>
                            <span id="productNewRemark">-</span>
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label">驳回原因（必填）</label>
                        <textarea id="productNewRejectReason" class="form-input" placeholder="若不通过，请说明不符合的项及整改建议"></textarea>
                    </div>
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="submitProductNewDecision('approved')">审核通过</button>
                        <button class="btn btn-secondary" onclick="submitProductNewDecision('rejected')">驳回并记录原因</button>
                    </div>
                </div>
                </div>
            </div>

            <div id="admin-product-approve-change" class="page">
                <h1 class="page-title">审核变更商品</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>核对变更前后差异，确认是否可以上线</div>
                <div class="form-section">
                    <div class="info-banner">变更项覆盖分类、名称、定价、分账比例、图片等信息。请对照历史值决定是否通过，并在驳回时写明原因。</div>
                    <table class="product-table" id="productChangeTable">
                        <thead>
                            <tr>
                                <th>变更编号</th>
                                <th>商品名称</th>
                                <th>所属商铺</th>
                                <th>提交时间</th>
                                <th>主要变更项</th>
                                <th>查看</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-id="PC-7001">
                                <td>PC-7001</td>
                                <td>智能手表 X</td>
                                <td>示例商户A</td>
                                <td>2025-10-19 09:15</td>
                                <td>销售价格、分账比例</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectProductChange('PC-7001')">查看详情</button></td>
                            </tr>
                            <tr data-id="PC-7002">
                                <td>PC-7002</td>
                                <td>有机咖啡豆</td>
                                <td>示例商户B</td>
                                <td>2025-10-20 16:40</td>
                                <td>商品图片</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectProductChange('PC-7002')">查看详情</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <div id="productChangeDetail" class="detail-card">
                        <h2 class="form-title"><div class="form-title-icon"></div>变更内容详情 <span class="status-tag">待审核</span></h2>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>变更编号</strong><span id="productChangeCurrentId">请选择变更项</span></div>
                            <div class="detail-item"><strong>商品名称</strong><span id="productChangeName">-</span></div>
                            <div class="detail-item"><strong>所属商铺</strong><span id="productChangeShop">-</span></div>
                            <div class="detail-item"><strong>当前分类</strong><span id="productChangeCategory">-</span></div>
                            <div class="detail-item"><strong>当前价格</strong><span id="productChangePrice">-</span></div>
                            <div class="detail-item"><strong>当前分账比例</strong><span id="productChangeShare">-</span></div>
                        </div>
                        <div class="detail-item" style="margin-top:12px;">
                            <strong>变更内容比对</strong>
                            <ul class="history-list" id="productChangeDiff"><li>未选择变更项</li></ul>
                        </div>
                        <div class="detail-grid full-width">
                            <div class="detail-item">
                                <strong>提交时间</strong>
                                <span id="productChangeSubmit">-</span>
                            </div>
                            <div class="detail-item">
                                <strong>附件</strong>
                                <ul class="history-list" id="productChangeAttachments"><li>未选择变更项</li></ul>
                            </div>
                        </div>
                        <div class="form-group full-width" style="margin-top:15px;">
                            <label class="form-label">驳回原因（必填）</label>
                            <textarea id="productChangeRejectReason" class="form-input" placeholder="若不通过，请写明未符合的规范"></textarea>
                        </div>
                        <div class="form-buttons">
                            <button class="btn btn-primary" onclick="submitProductChangeDecision('approved')">审核通过</button>
                            <button class="btn btn-secondary" onclick="submitProductChangeDecision('rejected')">驳回并记录原因</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="admin-product-category-create" class="page">
                <h1 class="page-title">建立商品分类</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>建立一级/二级商品分类并维护分账比例</div>
                <div class="form-section">
                    <div class="info-banner">为每个一级分类维护对应分账比例，新增二级分类时需校验重名。若因重名导致失败，请调整分类名称后重新提交。</div>
                    <h2 class="form-title"><div class="form-title-icon"></div>现有分类概览</h2>
                    <table class="product-table" id="categoryOverviewTable">
                        <thead>
                            <tr>
                                <th>一级分类</th>
                                <th>分账比例</th>
                                <th>该分类下商品数</th>
                                <th>二级分类</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>数码家电</td>
                                <td>15%</td>
                                <td>128</td>
                                <td>智能穿戴、影音设备、智能家居</td>
                            </tr>
                            <tr>
                                <td>食品饮料</td>
                                <td>12%</td>
                                <td>86</td>
                                <td>咖啡饮品、进口零食、有机食品</td>
                            </tr>
                            <tr>
                                <td>居家生活</td>
                                <td>10%</td>
                                <td>64</td>
                                <td>日用百货、收纳整理、家居饰品</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2 class="form-title"><div class="form-title-icon"></div>新增一级分类</h2>
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">一级分类名称 *</label><input id="newCategoryName" class="form-input" placeholder="如：母婴亲子"/></div>
                        <div class="form-group"><label class="form-label">分账比例 *</label><input id="newCategoryShare" class="form-input" placeholder="请输入百分比，例如 9%"/></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="handleCategoryCreate('level1')">提交新增一级分类</button></div>

                    <h2 class="form-title"><div class="form-title-icon"></div>在一级分类下新增二级分类</h2>
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">所属一级分类 *</label>
                            <select id="newSubcategoryParent" class="form-input">
                                <option value="">请选择</option>
                                <option value="数码家电">数码家电</option>
                                <option value="食品饮料">食品饮料</option>
                                <option value="居家生活">居家生活</option>
                            </select>
                        </div>
                        <div class="form-group"><label class="form-label">二级分类名称 *</label><input id="newSubcategoryName" class="form-input" placeholder="如：智能厨房"/></div>
                        <div class="form-group"><label class="form-label">分账比例 *</label><input id="newSubcategoryShare" class="form-input" placeholder="请输入百分比，例如 11%"/></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="handleCategoryCreate('level2')">提交新增二级分类</button></div>
                </div>
            </div>

            <div id="admin-product-category-delete" class="page">
                <h1 class="page-title">删除商品分类</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>删除一级或二级分类并同步处理分账比例</div>
                <div class="form-section">
                    <div class="info-banner">删除分类时，系统会将原分类的分账比例固化到分类下所有商品上，并提示这些商品当前处于“无分类”状态。</div>
                    <table class="product-table" id="categoryDeleteTable">
                        <thead>
                            <tr>
                                <th>分类编号</th>
                                <th>分类名称</th>
                                <th>级别</th>
                                <th>上级分类</th>
                                <th>当前商品数</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>CAT-L1-1001</td>
                                <td>数码家电</td>
                                <td>一级</td>
                                <td>-</td>
                                <td>128</td>
                                <td class="action-buttons"><button class="btn btn-secondary" onclick="handleCategoryDelete('CAT-L1-1001','数码家电','level1')">删除一级分类</button></td>
                            </tr>
                            <tr>
                                <td>CAT-L2-2005</td>
                                <td>影音设备</td>
                                <td>二级</td>
                                <td>数码家电</td>
                                <td>34</td>
                                <td class="action-buttons"><button class="btn btn-secondary" onclick="handleCategoryDelete('CAT-L2-2005','影音设备','level2')">删除二级分类</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="admin-product-category-update" class="page">
                <h1 class="page-title">修改商品分类</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>显示所有一级分类；选中后可编辑名称与分账比例，并查看/修改其二级分类</div>
                <div class="form-section">
                    <div class="info-banner">规则：同级分类不允许重名；分账比例请输入 0-100 的数字（单位：%）。</div>
                    <h2 class="form-title"><div class="form-title-icon"></div>一级分类</h2>
                    <table class="product-table">
                        <thead><tr><th>编号</th><th>名称</th><th>分账比例(%)</th><th>操作</th></tr></thead>
                        <tbody id="categoryL1Body"></tbody>
                    </table>

                    <div class="detail-card">
                        <h3 class="form-title"><div class="form-title-icon"></div>编辑一级分类</h3>
                        <div class="detail-grid">
                            <div class="form-group"><label class="form-label">编号</label><input id="catL1Id" class="form-input" readonly></div>
                            <div class="form-group"><label class="form-label">名称 *</label><input id="catL1NameInput" class="form-input" placeholder="请输入新名称"></div>
                            <div class="form-group"><label class="form-label">分账比例(%) *</label><input id="catL1ShareInput" class="form-input" placeholder="如 12"></div>
                        </div>
                        <div class="form-buttons"><button class="btn btn-warning" onclick="saveCategoryL1()">保存一级分类</button></div>
                    </div>

                    <h2 class="form-title" style="margin-top:16px;"><div class="form-title-icon"></div>二级分类</h2>
                    <table class="product-table">
                        <thead><tr><th>编号</th><th>名称</th><th>分账比例(%)</th><th>操作</th></tr></thead>
                        <tbody id="categoryL2Body"><tr><td colspan="4" style="text-align:center;color:#888;">请选择一个一级分类查看其下属二级分类</td></tr></tbody>
                    </table>
                    <div class="detail-card">
                        <h3 class="form-title"><div class="form-title-icon"></div>编辑二级分类</h3>
                        <div class="detail-grid">
                            <div class="form-group"><label class="form-label">编号</label><input id="catL2Id" class="form-input" readonly></div>
                            <div class="form-group"><label class="form-label">上级分类</label><input id="catL2Parent" class="form-input" readonly></div>
                            <div class="form-group"><label class="form-label">名称 *</label><input id="catL2NameInput" class="form-input" placeholder="请输入新名称"></div>
                            <div class="form-group"><label class="form-label">分账比例(%) *</label><input id="catL2ShareInput" class="form-input" placeholder="如 10"></div>
                        </div>
                        <div class="form-buttons"><button class="btn btn-warning" onclick="saveCategoryL2()">保存二级分类</button></div>
                    </div>
                </div>
            </div>

            <div id="admin-product-query" class="page">
                <h1 class="page-title">查询商品</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>按商品名称、商铺或分类检索；结果展示新增/变更审核信息</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">商品名称</label><input id="adminProductNameInput" class="form-input" placeholder="如：矿泉水"></div>
                        <div class="form-group"><label class="form-label">商铺名称</label><input id="adminProductShopInput" class="form-input" placeholder="如：华南商贸"></div>
                        <div class="form-group full-width"><label class="form-label">分类</label><input id="adminProductCategoryInput" class="form-input" placeholder="如：饮用水/休闲零食..."></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchAdminProducts()">查询</button></div>
                    <h2 class="form-title" style="margin-top:10px;"><div class="form-title-icon"></div>查询结果</h2>
                    <table class="product-table">
                        <thead><tr><th>商品名称</th><th>商铺名称</th><th>分类</th><th>原价(¥)</th><th>新增审核</th><th>变更审核</th><th>操作</th></tr></thead>
                        <tbody id="adminProductQueryBody"></tbody>
                    </table>
                    <div class="detail-card" id="adminProductDetail">
                        <h3 class="form-title"><div class="form-title-icon"></div>商品详情</h3>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>商品名称</strong><span id="adminProdDetailName">-</span></div>
                            <div class="detail-item"><strong>商铺名称</strong><span id="adminProdDetailShop">-</span></div>
                            <div class="detail-item"><strong>分类</strong><span id="adminProdDetailCategory">-</span></div>
                            <div class="detail-item"><strong>原价</strong><span id="adminProdDetailOriginal">-</span></div>
                            <div class="detail-item"><strong>新增审核</strong><span id="adminProdDetailAuditNew">-</span></div>
                            <div class="detail-item"><strong>变更审核</strong><span id="adminProdDetailAuditChange">-</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===================== 平台管理员：顾客子页面 ===================== -->
            <div id="admin-customer-ban" class="page">
                <h1 class="page-title">封禁顾客</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>系统展示符合条件的正常用户；选择后执行封禁</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">用户名/姓名</label><input id="banFilterName" class="form-input" placeholder="如：alice / 艾丽斯"></div>
                        <div class="form-group"><label class="form-label">手机号</label><input id="banFilterPhone" class="form-input" placeholder="如：138********"></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchCustomersBan()">查询</button></div>
                    <h2 class="form-title"><div class="form-title-icon"></div>可封禁的顾客</h2>
                    <table class="product-table"><thead><tr><th>用户名</th><th>姓名</th><th>电话</th><th>状态</th><th>操作</th></tr></thead><tbody id="banCustomerBody"></tbody></table>
                </div>
            </div>

            <div id="admin-customer-unban" class="page">
                <h1 class="page-title">解禁顾客</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>系统显示被封禁的顾客；选择后恢复</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">用户名/姓名</label><input id="unbanFilterName" class="form-input" placeholder="如：bob / 鲍勃"></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchCustomersUnban()">查询</button></div>
                    <h2 class="form-title"><div class="form-title-icon"></div>被封禁的顾客</h2>
                    <table class="product-table"><thead><tr><th>用户名</th><th>姓名</th><th>电话</th><th>状态</th><th>操作</th></tr></thead><tbody id="unbanCustomerBody"></tbody></table>
                </div>
            </div>

            <div id="admin-customer-query" class="page">
                <h1 class="page-title">查询顾客</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>可按手机号、用户名、姓名、状态筛选，并查看顾客详情</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">手机号</label><input id="custQueryPhone" class="form-input" placeholder="如：138********"></div>
                        <div class="form-group"><label class="form-label">用户名</label><input id="custQueryUsername" class="form-input" placeholder="如：alice"></div>
                        <div class="form-group"><label class="form-label">姓名</label><input id="custQueryName" class="form-input" placeholder="如：艾丽斯"></div>
                        <div class="form-group"><label class="form-label">状态</label>
                            <select id="custQueryStatus" class="form-input filter-select">
                                <option value="">全部</option>
                                <option>正常</option>
                                <option>已封禁</option>
                                <option>已注销</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchCustomersQuery()">查询</button></div>
                    <h2 class="form-title"><div class="form-title-icon"></div>查询结果</h2>
                    <table class="product-table"><thead><tr><th>用户名</th><th>姓名</th><th>电话</th><th>状态</th><th>操作</th></tr></thead><tbody id="adminCustomerQueryBody"></tbody></table>
                    <div class="detail-card"><h3 class="form-title"><div class="form-title-icon"></div>顾客详情</h3>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>用户名</strong><span id="custDetailUsername">-</span></div>
                            <div class="detail-item"><strong>姓名</strong><span id="custDetailName">-</span></div>
                            <div class="detail-item"><strong>电话</strong><span id="custDetailPhone">-</span></div>
                            <div class="detail-item"><strong>状态</strong><span id="custDetailStatus">-</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="admin-customer-deactivate" class="page">
                <h1 class="page-title">注销顾客</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>系统显示所有顾客，选择目标后执行注销</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">用户名/姓名</label><input id="deactFilterName" class="form-input" placeholder="模糊匹配"></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchCustomersDeactivate()">查询</button></div>
                    <h2 class="form-title"><div class="form-title-icon"></div>顾客列表</h2>
                    <table class="product-table"><thead><tr><th>用户名</th><th>姓名</th><th>电话</th><th>状态</th><th>操作</th></tr></thead><tbody id="deactCustomerBody"></tbody></table>
                </div>
            </div>

            <!-- ===================== 平台管理员：服务商子页面 ===================== -->
            <div id="admin-provider-approve-open" class="page">
                <h1 class="page-title">审核服务商开户</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>核对开户资料并给出审核结论</div>
                <div class="form-section">
                    <div class="info-banner">从列表中选择一条申请查看详情，确认后执行“审核通过”或“驳回并记录原因”。</div>
                    <table class="product-table" id="providerOpenTable">
                        <thead>
                            <tr>
                                <th>申请编号</th>
                                <th>服务商名称</th>
                                <th>联系人</th>
                                <th>联系电话</th>
                                <th>提交时间</th>
                                <th>查看</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-id="PO-3001">
                                <td>PO-3001</td>
                                <td>示例服务商A</td>
                                <td>王五</td>
                                <td>13900000001</td>
                                <td>2025-10-19 10:20</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectProviderOpen('PO-3001')">查看详情</button></td>
                            </tr>
                            <tr data-id="PO-3002">
                                <td>PO-3002</td>
                                <td>示例服务商B</td>
                                <td>赵六</td>
                                <td>13900000002</td>
                                <td>2025-10-20 16:05</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectProviderOpen('PO-3002')">查看详情</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <div id="providerOpenDetail" class="detail-card">
                        <h2 class="form-title"><div class="form-title-icon"></div>开户申请详情 <span class="status-tag">待审核</span></h2>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>申请编号</strong><span id="providerOpenCurrentId">请选择申请</span></div>
                            <div class="detail-item"><strong>服务商名称</strong><span id="providerOpenName">-</span></div>
                            <div class="detail-item"><strong>联系人</strong><span id="providerOpenContact">-</span></div>
                            <div class="detail-item"><strong>联系电话</strong><span id="providerOpenPhone">-</span></div>
                            <div class="detail-item"><strong>服务范围</strong><span id="providerOpenScope">-</span></div>
                            <div class="detail-item"><strong>所在地区</strong><span id="providerOpenRegion">-</span></div>
                            <div class="detail-item"><strong>注册地址</strong><span id="providerOpenAddress">-</span></div>
                            <div class="detail-item"><strong>营业执照编号</strong><span id="providerOpenLicense">-</span></div>
                        </div>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>执照有效期</strong><span id="providerOpenLicenseValid">-</span></div>
                            <div class="detail-item"><strong>开户银行信息</strong><span id="providerOpenBank">-</span></div>
                            <div class="detail-item"><strong>提交时间</strong><span id="providerOpenSubmit">-</span></div>
                            <div class="detail-item"><strong>备注</strong><span id="providerOpenRemark">-</span></div>
                        </div>
                        <div class="detail-grid full-width">
                            <div class="detail-item">
                                <strong>资质附件</strong>
                                <ul class="history-list" id="providerOpenAttachments"><li>未选择申请</li></ul>
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">驳回原因（必填）</label>
                            <textarea id="providerOpenRejectReason" class="form-input" placeholder="若驳回，请写明不通过原因"></textarea>
                        </div>
                        <div class="form-buttons">
                            <button class="btn btn-primary" onclick="submitProviderOpenDecision('approved')">审核通过</button>
                            <button class="btn btn-secondary" onclick="submitProviderOpenDecision('rejected')">驳回并记录原因</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="admin-provider-approve-change" class="page">
                <h1 class="page-title">审核服务商变更</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>核对变更内容并确认是否生效</div>
                <div class="form-section">
                    <div class="info-banner">请逐项核对变更内容，必要时要求补充材料。驳回需写明不通过的原因。</div>
                    <table class="product-table" id="providerChangeTable">
                        <thead>
                            <tr>
                                <th>变更编号</th>
                                <th>服务商名称</th>
                                <th>提交时间</th>
                                <th>主要变更项</th>
                                <th>查看</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-id="PCG-4001">
                                <td>PCG-4001</td>
                                <td>示例服务商A</td>
                                <td>2025-10-20 14:32</td>
                                <td>联系人、服务范围</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectProviderChange('PCG-4001')">查看详情</button></td>
                            </tr>
                            <tr data-id="PCG-4002">
                                <td>PCG-4002</td>
                                <td>示例服务商B</td>
                                <td>2025-10-21 09:18</td>
                                <td>注册地址</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectProviderChange('PCG-4002')">查看详情</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <div id="providerChangeDetail" class="detail-card">
                        <h2 class="form-title"><div class="form-title-icon"></div>变更详情 <span class="status-tag">待审核</span></h2>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>变更编号</strong><span id="providerChangeCurrentId">请选择变更申请</span></div>
                            <div class="detail-item"><strong>服务商名称</strong><span id="providerChangeName">-</span></div>
                            <div class="detail-item"><strong>联系人</strong><span id="providerChangeContact">-</span></div>
                            <div class="detail-item"><strong>联系电话</strong><span id="providerChangePhone">-</span></div>
                            <div class="detail-item"><strong>提交时间</strong><span id="providerChangeSubmit">-</span></div>
                            <div class="detail-item"><strong>附件</strong><span id="providerChangeAttachments">-</span></div>
                        </div>
                        <div class="detail-item" style="margin-top:12px;">
                            <strong>变更内容比对</strong>
                            <ul class="history-list" id="providerChangeDiff"><li>未选择申请</li></ul>
                        </div>
                        <div class="form-group full-width" style="margin-top:15px;">
                            <label class="form-label">驳回原因（必填）</label>
                            <textarea id="providerChangeRejectReason" class="form-input" placeholder="若不通过，请写明需要补充或修正的材料"></textarea>
                        </div>
                        <div class="form-buttons">
                            <button class="btn btn-primary" onclick="submitProviderChangeDecision('approved')">审核通过</button>
                            <button class="btn btn-secondary" onclick="submitProviderChangeDecision('rejected')">驳回并记录原因</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="admin-provider-suspend" class="page">
                <h1 class="page-title">暂停服务商</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>系统显示在营服务商；按名称筛选并执行暂停</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">服务商名称</label><input id="suspendProviderNameInput" class="form-input" placeholder="如：示例服务商A"></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchProvidersSuspend()">查询</button></div>
                    <h2 class="form-title"><div class="form-title-icon"></div>在营服务商</h2>
                    <table class="product-table"><thead><tr><th>服务商名称</th><th>联系电话</th><th>服务所在省市</th><th>操作</th></tr></thead><tbody id="providerSuspendBody"></tbody></table>
                </div>
            </div>

            <div id="admin-provider-resume" class="page">
                <h1 class="page-title">恢复服务商</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>系统显示被暂停服务商；按名称查询并恢复</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">服务商名称</label><input id="resumeProviderNameInput" class="form-input" placeholder="如：京东到家"></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchProvidersResume()">查询</button></div>
                    <h2 class="form-title"><div class="form-title-icon"></div>被暂停的服务商</h2>
                    <table class="product-table"><thead><tr><th>服务商名称</th><th>地区</th><th>联系电话</th><th>操作</th></tr></thead><tbody id="providerResumeBody"></tbody></table>
                </div>
            </div>

            <div id="admin-provider-query" class="page">
                <h1 class="page-title">查询服务商</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>输入条件检索服务商并查看详情</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">服务商名称</label><input id="adminProviderQueryInput" class="form-input" placeholder="如：示例服务商A"/></div>
                        <div class="form-group"><label class="form-label">服务商品类型</label>
                            <select id="adminProviderTypeSelect" class="form-input filter-select">
                                <option value="">全部</option>
                                <option value="仓配一体">仓配一体</option>
                                <option value="同城即时配送">同城即时配送</option>
                                <option value="省际干线运输">省际干线运输</option>
                                <option value="安装服务">安装服务</option>
                            </select>
                        </div>
                        <div class="form-group full-width"><label class="form-label">服务地区</label><input id="adminProviderRegionInput" class="form-input" placeholder="如：福建 厦门 或 浙江 杭州"/></div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchProviderList()">查询</button></div>

                    <h2 class="form-title" style="margin-top:10px;"><div class="form-title-icon"></div>查询结果</h2>
                    <table class="product-table">
                        <thead>
                            <tr><th>编号</th><th>服务商名称</th><th>服务商品类型</th><th>服务地区</th><th>操作</th></tr>
                        </thead>
                        <tbody id="adminProviderQueryBody"></tbody>
                    </table>

                    <div id="providerQueryDetail" class="detail-card">
                        <h3 class="form-title"><div class="form-title-icon"></div>服务商详情</h3>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>服务商名称</strong><span id="providerQueryName">-</span></div>
                            <div class="detail-item"><strong>服务商品类型</strong><span id="providerQueryTypes">-</span></div>
                            <div class="detail-item"><strong>服务地区</strong><span id="providerQueryRegion">-</span></div>
                            <div class="detail-item"><strong>联系人姓名</strong><span id="providerQueryContactName">-</span></div>
                            <div class="detail-item"><strong>联系电话</strong><span id="providerQueryContactPhone">-</span></div>
                            <div class="detail-item"><strong>联系地址</strong><span id="providerQueryContactAddress">-</span></div>
                        </div>
                        <div class="detail-grid full-width" style="margin-top:10px;">
                            <div class="detail-item"><strong>服务商简介</strong><div id="providerQueryIntro">-</div></div>
                            <div class="detail-item"><strong>服务资质证明</strong><ul id="providerQueryQualifications" class="history-list"><li>未选择服务商</li></ul></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===================== 平台管理员：活动子页面 ===================== -->
            <div id="admin-activity-approve" class="page">
                <h1 class="page-title">审核活动</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>核对活动方案与时段范围</div>
                <div class="form-section">
                    <div class="info-banner">从列表中选择活动查看详情，确认时间范围、参与范围与预算等是否合规，必要时驳回并附理由。</div>
                    <table class="product-table" id="activityApproveTable">
                        <thead>
                            <tr>
                                <th>活动编号</th>
                                <th>活动名称</th>
                                <th>发起方</th>
                                <th>提交时间</th>
                                <th>查看</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-id="AC-9001">
                                <td>AC-9001</td>
                                <td>双十一大促</td>
                                <td>示例商户A</td>
                                <td>2025-10-15 11:00</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectActivityApprove('AC-9001')">查看详情</button></td>
                            </tr>
                            <tr data-id="AC-9002">
                                <td>AC-9002</td>
                                <td>年底清仓</td>
                                <td>示例商户B</td>
                                <td>2025-10-18 09:40</td>
                                <td class="action-buttons"><button class="btn-edit" onclick="selectActivityApprove('AC-9002')">查看详情</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <div id="activityApproveDetail" class="detail-card">
                        <h2 class="form-title"><div class="form-title-icon"></div>活动详情 <span class="status-tag">待审核</span></h2>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>活动编号</strong><span id="activityCurrentId">请选择活动</span></div>
                            <div class="detail-item"><strong>活动名称</strong><span id="activityName">-</span></div>
                            <div class="detail-item"><strong>发起方</strong><span id="activitySponsor">-</span></div>
                            <div class="detail-item"><strong>开始时间</strong><span id="activityStart">-</span></div>
                            <div class="detail-item"><strong>结束时间</strong><span id="activityEnd">-</span></div>
                            <div class="detail-item"><strong>参与范围</strong><span id="activityScope">-</span></div>
                        </div>
                        <div class="detail-grid full-width">
                            <div class="detail-item"><strong>提交时间</strong><span id="activitySubmit">-</span></div>
                            <div class="detail-item"><strong>备注</strong><span id="activityRemark">-</span></div>
                        </div>
                        <div class="detail-grid full-width">
                            <div class="detail-item">
                                <strong>附件</strong>
                                <ul class="history-list" id="activityAttachments"><li>未选择活动</li></ul>
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">驳回原因（必填）</label>
                            <textarea id="activityRejectReason" class="form-input" placeholder="若不通过，请说明不符合的问题"></textarea>
                        </div>
                        <div class="form-buttons">
                            <button class="btn btn-primary" onclick="submitActivityDecision('approved')">审核通过</button>
                            <button class="btn btn-secondary" onclick="submitActivityDecision('rejected')">驳回并记录原因</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="admin-activity-query" class="page">
                <h1 class="page-title">查询活动</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>支持名称、商户、时间范围、活动商品与状态筛选；展示审核通过的活动并可查看详情</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">活动名称</label><input id="activityNameInput" class="form-input" placeholder="如：双11大促"></div>
                        <div class="form-group"><label class="form-label">商户名称</label><input id="activityMerchantInput" class="form-input" placeholder="如：华南商贸"></div>
                        <div class="form-group"><label class="form-label">开始时间</label><input id="activityStartInput" class="form-input" placeholder="YYYY-MM-DD"></div>
                        <div class="form-group"><label class="form-label">结束时间</label><input id="activityEndInput" class="form-input" placeholder="YYYY-MM-DD"></div>
                        <div class="form-group"><label class="form-label">活动商品名称</label><input id="activityProductInput" class="form-input" placeholder="如：矿泉水"></div>
                        <div class="form-group"><label class="form-label">状态</label>
                            <select id="activityStatusSelect" class="form-input filter-select">
                                <option value="">全部</option>
                                <option>已上线</option>
                                <option>已结束</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-buttons"><button class="btn btn-primary" onclick="searchAdminActivities()">查询</button></div>
                    <h2 class="form-title" style="margin-top:10px;"><div class="form-title-icon"></div>查询结果</h2>
                    <table class="product-table"><thead><tr><th>编号</th><th>名称</th><th>商户</th><th>起止时间</th><th>状态</th><th>新增审核</th><th>变更审核</th><th>操作</th></tr></thead><tbody id="adminActivityQueryBody"></tbody></table>
                    <div class="detail-card">
                        <h3 class="form-title"><div class="form-title-icon"></div>活动详情</h3>
                        <div class="detail-grid">
                            <div class="detail-item"><strong>活动名称</strong><span id="actDetailName">-</span></div>
                            <div class="detail-item"><strong>商户名称</strong><span id="actDetailMerchant">-</span></div>
                            <div class="detail-item"><strong>起止时间</strong><span id="actDetailTime">-</span></div>
                            <div class="detail-item"><strong>状态</strong><span id="actDetailStatus">-</span></div>
                        </div>
                        <div class="detail-grid full-width" style="margin-top:8px;">
                            <div class="detail-item"><strong>活动规则描述</strong><div id="actDetailRules">-</div></div>
                            <div class="detail-item"><strong>活动商品列表</strong><ul id="actDetailProducts" class="history-list"><li>未选择活动</li></ul></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 维修工 PC 页面 -->
    <div id="techApp" class="container" style="display: none;">
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="back-arrow">←</div>
                <div class="nav-title">导航</div>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" onclick="showTechPage('tech-orders')">
                    <div class="nav-icon"></div>
                    待接收服务单
                </li>
                <li class="nav-item" onclick="showTechPage('tech-order-detail')">
                    <div class="nav-icon"></div>
                    服务单详情
                </li>
            </ul>
        </div>
        <div class="main-content">
            <div class="header">
                <div class="search-box">
                    <span>🔍</span>
                    <input type="text" class="search-input" id="techSearchInput" placeholder="输入：服务单/详情 等即可跳转" onkeydown="if(event.key==='Enter'){techSearchNavigate();}">
                </div>
                <div class="user-info">
                    <button class="btn btn-primary" style="padding:8px 12px;" onclick="switchToTechMobile()">移动端视图</button>
                    <span class="welcome-text" id="welcomeTextTech">欢迎你! 维修工</span>
                    <span>▼</span>
                    <div class="user-avatar" onclick="logout()" title="退出登录">🛠️</div>
                </div>
            </div>

            <!-- 待接收服务单列表 (MALL-SERVICE-031) -->
            <div id="tech-orders" class="page active">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <div>
                        <h1 class="page-title">待接收服务单</h1>
                        <div class="page-subtitle"><div class="subtitle-icon"></div>服务单信息（地区、商品、服务类型）</div>
                    </div>
                </div>

                <table class="product-table">
                    <thead>
                        <tr>
                            <th>地区</th>
                            <th>商品</th>
                            <th>服务类型</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="techOrderTable">
                        <tr>
                            <td>福建 厦门 翔安区</td>
                            <td>空调外机</td>
                            <td>上门维修</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-edit" onclick="viewTechOrder('SO-001')">查看</button>
                                    <button class="btn-edit" onclick="acceptTechOrder('SO-001')">接收</button>
                                    <button class="btn-delete" onclick="rejectTechOrder('SO-001')">拒绝</button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>福建 厦门 湖里区</td>
                            <td>冰箱压缩机</td>
                            <td>寄回维修</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-edit" onclick="viewTechOrder('SO-002')">查看</button>
                                    <button class="btn-edit" onclick="acceptTechOrder('SO-002')">接收</button>
                                    <button class="btn-delete" onclick="rejectTechOrder('SO-002')">拒绝</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 服务单详情 (展示接收前信息) -->
            <div id="tech-order-detail" class="page">
                <h1 class="page-title">服务单详情</h1>
                <div class="page-subtitle"><div class="subtitle-icon"></div>地区、商品、服务类型、商户信息、服务商信息、进度</div>
                <div class="form-section">
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">服务单号</label><input class="form-input" id="detailOrderId" value="SO-001"></div>
                        <div class="form-group"><label class="form-label">地区</label><input class="form-input" value="福建 厦门 翔安区"></div>
                        <div class="form-group"><label class="form-label">商品</label><input class="form-input" value="空调外机"></div>
                        <div class="form-group"><label class="form-label">服务类型</label><input class="form-input" value="上门维修"></div>
                        <div class="form-group"><label class="form-label">商户信息</label><input class="form-input" value="豪客来商店"></div>
                        <div class="form-group"><label class="form-label">服务商信息</label><input class="form-input" value="厦门维修服务中心"></div>
                        <div class="form-group full-width"><label class="form-label">进度</label><input class="form-input" value="待接收"></div>
                    </div>
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="acceptTechOrder(document.getElementById('detailOrderId').value)">接收</button>
                        <button class="btn btn-secondary" onclick="rejectTechOrder(document.getElementById('detailOrderId').value)">拒绝</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 维修工 移动端页面 -->
    <div id="techMobile" style="display:none;">
        <div class="login-container" style="height:auto; background:#fff;">
            <div class="login-card" style="max-width:600px; width:100%;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
                    <div class="login-logo">🛠️</div>
                    <button class="btn btn-primary" style="padding:8px 14px;" onclick="backToTechPC()">切换到PC视图</button>
                </div>
                <h2 class="login-title" style="margin:10px 0 6px;">维修工-服务单</h2>
                <div class="search-box" style="margin:10px 0 15px;">
                    <span>🔍</span>
                    <input type="text" class="search-input" id="techMobileSearch" placeholder="输入任意内容即可跳转" onkeydown="if(event.key==='Enter'){techMobileSearchNavigate();}">
                </div>
                <div style="text-align:left;">
                    <!-- 列表视图 -->
                    <div id="techMobileList" class="form-section" style="padding:15px;">
                        <div style="font-weight:bold;margin-bottom:10px;">待接收服务单</div>
                        <div style="display:flex;flex-direction:column;gap:10px;">
                            <div style="border:1px solid #eee;border-radius:8px;padding:12px;">
                                <div style="font-size:14px;margin-bottom:6px;">SO-001 · 厦门翔安区 · 上门维修 · 空调外机</div>
                                <div style="display:flex;gap:8px;">
                                    <button class="btn-edit" onclick="viewTechOrderMobile('SO-001')">查看</button>
                                    <button class="btn-edit" onclick="acceptTechOrder('SO-001')">接收</button>
                                    <button class="btn-delete" onclick="rejectTechOrder('SO-001')">拒绝</button>
                                </div>
                            </div>
                            <div style="border:1px solid #eee;border-radius:8px;padding:12px;">
                                <div style="font-size:14px;margin-bottom:6px;">SO-002 · 厦门湖里区 · 寄回维修 · 冰箱压缩机</div>
                                <div style="display:flex;gap:8px;">
                                    <button class="btn-edit" onclick="viewTechOrderMobile('SO-002')">查看</button>
                                    <button class="btn-edit" onclick="acceptTechOrder('SO-002')">接收</button>
                                    <button class="btn-delete" onclick="rejectTechOrder('SO-002')">拒绝</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 详情视图 -->
                    <div id="techMobileDetail" class="form-section" style="padding:15px; display:none;">
                        <div style="font-weight:bold;margin-bottom:10px;">服务单详情</div>
                        <div class="form-grid" style="grid-template-columns:1fr;">
                            <div class="form-group"><label class="form-label">服务单号</label><input class="form-input" id="techMobileDetailId" value="SO-001"></div>
                            <div class="form-group"><label class="form-label">地区</label><input class="form-input" value="福建 厦门 翔安区"></div>
                            <div class="form-group"><label class="form-label">商品</label><input class="form-input" value="空调外机"></div>
                            <div class="form-group"><label class="form-label">服务类型</label><input class="form-input" value="上门维修"></div>
                            <div class="form-group"><label class="form-label">商户信息</label><input class="form-input" value="豪客来商店"></div>
                            <div class="form-group"><label class="form-label">服务商信息</label><input class="form-input" value="厦门维修服务中心"></div>
                            <div class="form-group"><label class="form-label">进度</label><input class="form-input" value="待接收"></div>
                        </div>
                        <div class="form-buttons" style="justify-content:flex-end;">
                            <button class="btn btn-secondary" onclick="showTechMobilePage('list')">返回</button>
                            <button class="btn btn-primary" onclick="acceptTechOrder(document.getElementById('techMobileDetailId').value)">接收</button>
                            <button class="btn btn-secondary" onclick="rejectTechOrder(document.getElementById('techMobileDetailId').value)">拒绝</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 弹窗组件 -->
    <div id="modalOverlay" class="modal-overlay">
        <div class="modal">
            <div id="modalIcon" class="modal-icon success">✓</div>
            <div id="modalTitle" class="modal-title">操作成功</div>
            <div id="modalMessage" class="modal-message">操作已完成</div>
            <div class="modal-buttons">
                <button id="modalConfirmBtn" class="modal-btn modal-btn-primary" onclick="hideModal()">确定</button>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let currentUser = null;
        let selectedRole = null;

        const adminSelections = {
            merchantOpen: null,
            merchantChange: null,
            productNew: null,
            productChange: null,
            providerOpen: null,
            providerChange: null,
            activityReview: null,
            providerQuery: null
        };

        const adminMockData = {
            merchantOpen: {
                'AO-2025001': {
                    id: 'AO-2025001',
                    merchantName: '示例商户A',
                    contact: '张三',
                    phone: '13000000001',
                    scope: '电子产品、智能穿戴设备销售',
                    region: '福建省 厦门市 思明区',
                    address: '厦门市思明区演示路88号A座20层',
                    share: '数码产品 · 平台分账 15%',
                    licenseNo: '91350200MA9XXXXXX',
                    licenseValid: '2021-05-01 ~ 2031-05-01',
                    bank: '中国银行厦门分行 6222 **** 8888',
                    submitTime: '2025-10-20 09:30',
                    attachments: ['营业执照扫描件.pdf', '法人身份证.png'],
                    remark: '门店支持线上自提、线下体验'
                },
                'AO-2025002': {
                    id: 'AO-2025002',
                    merchantName: '示例商户B',
                    contact: '李四',
                    phone: '13000000002',
                    scope: '精品食品、进口饮品零售',
                    region: '上海市 浦东新区 花木街道',
                    address: '花木路99号浦东国际金融中心3层',
                    share: '食品饮料 · 平台分账 12%',
                    licenseNo: '91310115MA2XXXXX9',
                    licenseValid: '2022-01-01 ~ 2032-01-01',
                    bank: '工商银行上海花木支行 6212 **** 2233',
                    submitTime: '2025-10-21 11:05',
                    attachments: ['营业执照.pdf', '食品经营许可证.jpg'],
                    remark: '已在平台完成保证金冻结'
                }
            },
            merchantChange: {
                'MC-1001': {
                    id: 'MC-1001',
                    merchantName: '示例商户A',
                    contact: '李晓',
                    phone: '13000000003',
                    submitTime: '2025-10-18 14:22',
                    attachments: ['新版营业执照.pdf'],
                    diffs: [
                        { field: '注册地址', oldValue: '厦门市思明区建业路1号', newValue: '厦门市湖里区光明路18号' },
                        { field: '联系人', oldValue: '张三', newValue: '李晓' }
                    ]
                },
                'MC-1002': {
                    id: 'MC-1002',
                    merchantName: '示例商户B',
                    contact: '王梅',
                    phone: '13100000008',
                    submitTime: '2025-10-19 10:06',
                    attachments: ['经营范围变更申请.pdf'],
                    diffs: [
                        { field: '经营范围', oldValue: '咖啡豆及器具零售', newValue: '咖啡豆、烘焙食品零售' }
                    ]
                }
            },
            productNew: {
                'NP-5001': {
                    id: 'NP-5001',
                    name: '智能手表 X',
                    shop: '示例商户A',
                    category: '数码家电 / 智能穿戴',
                    originalPrice: '¥999.00',
                    salePrice: '¥899.00',
                    unit: '件',
                    origin: '中国',
                    barcode: '6920000000001',
                    share: '分账比例 15%',
                    shareCategory: '数码家电类',
                    submitTime: '2025-10-20 10:12',
                    attachments: ['商品主图.jpg', '参数手册.pdf'],
                    remark: '支持NFC和蓝牙通话'
                },
                'NP-5002': {
                    id: 'NP-5002',
                    name: '有机咖啡豆 500g',
                    shop: '示例商户B',
                    category: '食品饮料 / 咖啡豆',
                    originalPrice: '¥138.00',
                    salePrice: '¥128.00',
                    unit: '袋',
                    origin: '哥伦比亚',
                    barcode: '6930000001122',
                    share: '分账比例 12%',
                    shareCategory: '食品饮料类',
                    submitTime: '2025-10-21 08:55',
                    attachments: ['商品主图.jpg', '产地证明.pdf'],
                    remark: '原产地直供，需冷链仓储'
                }
            },
            productChange: {
                'PC-7001': {
                    id: 'PC-7001',
                    name: '智能手表 X',
                    shop: '示例商户A',
                    category: '数码家电 / 智能穿戴',
                    price: '¥899.00',
                    share: '15%',
                    submitTime: '2025-10-19 09:15',
                    attachments: ['新版商品主图.jpg'],
                    diffs: [
                        { field: '销售价格', oldValue: '¥999.00', newValue: '¥899.00' },
                        { field: '分账比例', oldValue: '18%', newValue: '15%' }
                    ]
                },
                'PC-7002': {
                    id: 'PC-7002',
                    name: '有机咖啡豆 500g',
                    shop: '示例商户B',
                    category: '食品饮料 / 咖啡豆',
                    price: '¥128.00',
                    share: '12%',
                    submitTime: '2025-10-20 16:40',
                    attachments: ['产品图片新版.zip'],
                    diffs: [
                        { field: '商品图片', oldValue: '咖啡豆旧版主图', newValue: '上传新版主图（含产地标识）' }
                    ]
                }
            },
            merchantSearch: {
                suspend: [
                    {
                        id: 'M2023001',
                        name: '示例商户A',
                        contact: '李晓',
                        phone: '13000000003',
                        region: '福建省/厦门市/湖里区',
                        address: '湖里区光明路18号',
                        status: '在营'
                    },
                    {
                        id: 'M2023002',
                        name: '海风家居馆',
                        contact: '周航',
                        phone: '13000000004',
                        region: '浙江省/宁波市/鄞州区',
                        address: '鄞州区环城南路200号',
                        status: '在营'
                    }
                ],
                resume: [
                    {
                        id: 'M2022011',
                        name: '拼味零食铺',
                        contact: '赵倩',
                        phone: '13100000015',
                        region: '广东省/深圳市/福田区',
                        address: '福田区益田路300号',
                        status: '暂停'
                    },
                    {
                        id: 'M2022018',
                        name: '泉韵茶庄',
                        contact: '吴迪',
                        phone: '13100000026',
                        region: '福建省/泉州市/丰泽区',
                        address: '丰泽区津淮街128号',
                        status: '暂停'
                    }
                ]
            }
            ,
            providerSearch: [
                {
                    id: 'S1001',
                    name: '示例服务商A',
                    types: ['仓配一体','同城即时配送'],
                    region: '福建省 厦门市',
                    contactName: '王五',
                    contactPhone: '13900000001',
                    contactAddress: '厦门市湖里区高林中路66号',
                    intro: '覆盖厦门全域，提供仓储、分拣与同城即时配送一体化服务。',
                    qualifications: ['营业执照.pdf','运输资质.jpg'],
                    status: 'active'
                },
                {
                    id: 'S1002',
                    name: '示例服务商B',
                    types: ['省际干线运输'],
                    region: '浙江省 杭州市',
                    contactName: '赵六',
                    contactPhone: '13900000002',
                    contactAddress: '杭州市余杭区科创路99号',
                    intro: '长三角区域省际干线运输网络完善，时效稳定。',
                    qualifications: ['营业执照.pdf'],
                    status: 'suspended'
                },
                {
                    id: 'S1003',
                    name: '安心安装服务',
                    types: ['安装服务','售后维护'],
                    region: '广东省 深圳市',
                    contactName: '李强',
                    contactPhone: '13900000003',
                    contactAddress: '深圳市福田区益田路300号',
                    intro: '覆盖家电安装与售后维护，服务规范，评价良好。',
                    qualifications: ['服务认证书.pdf','质检合格证明.jpg'],
                    status: 'active'
                }
            ],
            providerOpen: {
                'PO-3001': {
                    id: 'PO-3001', providerName: '示例服务商A', contact: '王五', phone: '13900000001', scope: '仓配一体、同城即时配送', region: '福建省 厦门市 湖里区', address: '厦门市湖里区高林中路66号', licenseNo: 'SP91350200MA9XXXX01', licenseValid: '2020-01-01 ~ 2030-01-01', bank: '建设银行厦门嘉园支行 6222 **** 5566', submitTime: '2025-10-19 10:20', attachments: ['营业执照.pdf','运输资质.jpg'], remark: '覆盖厦门全域'
                },
                'PO-3002': {
                    id: 'PO-3002', providerName: '示例服务商B', contact: '赵六', phone: '13900000002', scope: '省际干线运输', region: '浙江省 杭州市 余杭区', address: '余杭区科技大道88号', licenseNo: 'SP91330110MA2XXXX02', licenseValid: '2021-06-01 ~ 2031-06-01', bank: '招商银行杭州分行 6214 **** 7788', submitTime: '2025-10-20 16:05', attachments: ['营业执照.pdf'], remark: '长三角覆盖'
                }
            },
            providerChange: {
                'PCG-4001': { id: 'PCG-4001', providerName: '示例服务商A', contact: '王五', phone: '13900000001', submitTime: '2025-10-20 14:32', attachments: ['联系人变更申请.pdf'], diffs: [ {field:'联系人', oldValue:'王五', newValue:'王维'}, {field:'服务范围', oldValue:'仓配一体', newValue:'仓配一体、同城即时配送'} ] },
                'PCG-4002': { id: 'PCG-4002', providerName: '示例服务商B', contact: '赵六', phone: '13900000002', submitTime: '2025-10-21 09:18', attachments: [], diffs: [ {field:'地址', oldValue:'余杭区科技大道88号', newValue:'余杭区科创路99号'} ] }
            },
            activityApprove: {
                'AC-9001': { id: 'AC-9001', name: '双十一大促', sponsor: '示例商户A', startTime: '2025-11-01', endTime: '2025-11-12', scope: '全场部分类目', submitTime: '2025-10-15 11:00', attachments: ['活动方案.pdf','预算表.xlsx'], remark: '需风控复核' },
                'AC-9002': { id: 'AC-9002', name: '年底清仓', sponsor: '示例商户B', startTime: '2025-12-20', endTime: '2025-12-31', scope: '自营店铺', submitTime: '2025-10-18 09:40', attachments: ['活动海报.jpg'], remark: '' }
            },
            // ===== 下面为新增数据集：商品分类 / 商品查询 / 活动查询 / 顾客管理 =====
            productCategories: {
                level1: [
                    { id: 'C1', name: '食品饮料', share: 12, children: [
                        { id: 'C1-1', name: '休闲零食', share: 10 },
                        { id: 'C1-2', name: '饮用水', share: 8 }
                    ]},
                    { id: 'C2', name: '家居日用', share: 10, children: [
                        { id: 'C2-1', name: '清洁用品', share: 9 },
                        { id: 'C2-2', name: '厨房用品', share: 11 }
                    ]}
                ]
            },
            productSearch: [
                { id: 'P1001', name: '百岁山矿泉水', shopName: '华南商贸', category: '饮用水', originalPrice: 4.50, auditNew: '已通过(2025-09-12)', auditChange: '无' },
                { id: 'P1002', name: '乐事薯片-原味', shopName: '零食铺子', category: '休闲零食', originalPrice: 6.80, auditNew: '已通过(2025-08-03)', auditChange: '驳回(2025-10-10)' },
                { id: 'P1003', name: '不锈钢菜刀', shopName: '居家优选', category: '厨房用品', originalPrice: 29.90, auditNew: '已通过(2025-07-21)', auditChange: '已通过(2025-09-30)'}
            ],
            activities: [
                { id: 'A9001', name: '双11大促', merchantName: '华南商贸', startTime: '2025-11-10 00:00', endTime: '2025-11-12 23:59', status: '已上线', productNames: ['百岁山矿泉水','乐事薯片-原味'], audits: { new: '已通过(2025-10-20)', change: '无' }, rules: '满100减20；部分商品不参与叠加' },
                { id: 'A9002', name: '开学季', merchantName: '零食铺子', startTime: '2025-08-20 00:00', endTime: '2025-09-10 23:59', status: '已结束', productNames: ['乐事薯片-原味'], audits: { new: '已通过(2025-08-10)', change: '已通过(2025-08-28)' }, rules: '第二件半价；指定SKU' }
            ],
            customers: [
                { id: 'U1001', username: 'alice', name: '艾丽斯', phone: '13800000011', status: '正常' },
                { id: 'U1002', username: 'bob', name: '鲍勃', phone: '13900000022', status: '已封禁' },
                { id: 'U1003', username: 'cindy', name: '辛迪', phone: '13700000033', status: '正常' }
            ]
        };

        // 角色选择功能
        function selectRole(role) {
            selectedRole = role;
            
            // 启用或禁用登录按钮
            const loginBtn = document.getElementById('loginBtn');
            if (role && role !== '') {
                loginBtn.disabled = false;
                
                // 更新欢迎文本
                const roleNames = {
                    'merchant': '商户',
                    'service-provider': '服务商',
                    'platform-admin': '平台管理人员',
                    'technician': '维修工'
                };
                document.getElementById('welcomeText').textContent = `欢迎你! ${roleNames[role]}`;
            } else {
                loginBtn.disabled = true;
            }
        }

        // 登录处理
        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            if (!selectedRole) {
                showModal('warning', '请选择角色', '请先选择您的角色类型。', '⚠');
                return;
            }
            
            if (!username || !password) {
                showModal('warning', '请填写完整信息', '请输入用户名和密码。', '⚠');
                return;
            }
            
            // 模拟登录验证 - 支持多个测试账号
            const validAccounts = [
                { username: 'admin', password: '123456' },
                { username: 'merchant', password: 'merchant123' },
                { username: 'service', password: 'service123' },
                { username: 'platform', password: 'platform123' },
                { username: 'repair', password: 'repair123' },
                { username: 'test', password: 'test123' },
                { username: 'user', password: 'user123' }
            ];
            
            const isValidAccount = validAccounts.some(account => 
                account.username === username && account.password === password
            );
            
            if (isValidAccount) {
                // 登录成功
                currentUser = {
                    username: username,
                    role: selectedRole,
                    roleName: {
                        'merchant': '商户',
                        'service-provider': '服务商',
                        'platform-admin': '平台管理人员',
                        'technician': '维修工'
                    }[selectedRole]
                };
                
                showModal('success', '登录成功', `欢迎回来，${currentUser.roleName}！`, '✓');
                
                setTimeout(() => {
                    hideModal();
                    showMainApp();
                }, 1500);
            } else {
                showModal('warning', '登录失败', '用户名或密码错误，请重试。\n\n测试账号：\n用户名: admin, 密码: 123456\n用户名: test, 密码: test123', '⚠');
            }
        }

        // 显示主应用
        function showMainApp() {
            document.getElementById('loginPage').style.display = 'none';
            if (currentUser.role === 'technician') {
                document.getElementById('techApp').style.display = 'flex';
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('techMobile').style.display = 'none';
                document.getElementById('welcomeTextTech').textContent = `欢迎你! ${currentUser.roleName}`;
                showTechPage('tech-orders');
            } else {
                document.getElementById('mainApp').style.display = 'flex';
                document.getElementById('techApp').style.display = 'none';
                document.getElementById('techMobile').style.display = 'none';
                
                // 更新欢迎文本
                document.getElementById('welcomeText').textContent = `欢迎你! ${currentUser.roleName}`;
                
                // 根据角色渲染导航并设置默认页面
                renderNavForRole(currentUser.role);
                attachGlobalSearch();
                if (currentUser.role === 'platform-admin') {
                    showPage('admin-merchants');
                } else {
                    showPage('account-info');
                }
            }
        }

        // 退出登录
        function logout() {
            if (confirm('确定要退出登录吗？')) {
                currentUser = null;
                selectedRole = null;
                
                // 重置登录表单
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                document.getElementById('loginBtn').disabled = true;
                document.getElementById('roleSelect').value = '';
                
                // 显示登录页面
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('techApp').style.display = 'none';
                document.getElementById('techMobile').style.display = 'none';
                document.getElementById('loginPage').style.display = 'flex';
            }
        }

        // 弹窗功能
        function showModal(type, title, message, icon = '✓') {
            const modalOverlay = document.getElementById('modalOverlay');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            
            // 设置图标和样式
            modalIcon.textContent = icon;
            modalIcon.className = `modal-icon ${type}`;
            
            // 设置标题和消息
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            
            // 显示弹窗
            modalOverlay.classList.add('show');
        }

        function hideModal() {
            const modalOverlay = document.getElementById('modalOverlay');
            modalOverlay.classList.remove('show');
        }

        // 点击遮罩层关闭弹窗
        document.getElementById('modalOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                hideModal();
            }
        });

        // ESC键关闭弹窗
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                hideModal();
            }
        });

        // 页面切换功能
        function showPage(pageId) {
            // 隐藏所有页面
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            // 显示目标页面
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // 更新导航状态
            setActiveNavForPage(pageId);

            ensureSelectionDefaults(pageId);

            // 进入查询页面时绑定回车查询
            const queryBindings = {
                'admin-product-query': ['adminProductQueryInput','adminProductQueryBody'],
                'admin-customer-query': ['adminCustomerQueryInput','adminCustomerQueryBody'],
                'admin-activity-query': ['adminActivityQueryInput','adminActivityQueryBody'],
                'admin-provider-query': ['adminProviderQueryInput','adminProviderQueryBody']
            };
            if (queryBindings[pageId]) {
                const [inp, body] = queryBindings[pageId];
                bindEnterToShowResults(inp, body);
            }

            // 查询服务商页：为多个筛选控件绑定 Enter 触发查询
            if (pageId === 'admin-provider-query') {
                const nameInp = document.getElementById('adminProviderQueryInput');
                const regionInp = document.getElementById('adminProviderRegionInput');
                const typeSel = document.getElementById('adminProviderTypeSelect');
                const bindEnter = (el) => { if (!el) return; el.onkeydown = (e)=>{ if (e.key === 'Enter') searchProviderList(); }; };
                bindEnter(nameInp); bindEnter(regionInp); bindEnter(typeSel);
            }

            // 自动展示/刷新数据：符合“系统显示…”的用例要求
            try {
                if (pageId === 'admin-product-category-update') renderCategoryL1();
                if (pageId === 'admin-product-query') searchAdminProducts();
                if (pageId === 'admin-activity-query') searchAdminActivities();
                if (pageId === 'admin-customer-ban') searchCustomersBan();
                if (pageId === 'admin-customer-unban') searchCustomersUnban();
                if (pageId === 'admin-customer-query') searchCustomersQuery();
                if (pageId === 'admin-customer-deactivate') searchCustomersDeactivate();
                if (pageId === 'admin-provider-suspend') searchProvidersSuspend();
                if (pageId === 'admin-provider-resume') searchProvidersResume();
            } catch(err) { /* 初次加载函数尚未定义时忽略 */ }
        }

        // 根据当前角色渲染侧边导航
        function renderNavForRole(role) {
            const navMenu = document.querySelector('.nav-menu');
            if (!navMenu) return;
            if (role === 'platform-admin') {
                navMenu.innerHTML = `
                    <li class="nav-item" data-nav="admin-merchants" onclick="showPage('admin-merchants')">
                        <div class="nav-icon"></div>
                        管理商户
                    </li>
                    <li class="nav-item" data-nav="admin-products" onclick="showPage('admin-products')">
                        <div class="nav-icon"></div>
                        管理商品
                    </li>
                    <li class="nav-item" data-nav="admin-customers" onclick="showPage('admin-customers')">
                        <div class="nav-icon"></div>
                        管理顾客
                    </li>
                    <li class="nav-item" data-nav="admin-providers" onclick="showPage('admin-providers')">
                        <div class="nav-icon"></div>
                        管理服务商
                    </li>
                    <li class="nav-item" data-nav="admin-activities" onclick="showPage('admin-activities')">
                        <div class="nav-icon"></div>
                        管理活动
                    </li>
                `;
            } else {
                // 商户/其他角色：恢复原有导航
                navMenu.innerHTML = `
                    <li class="nav-item" onclick="showPage('account-opening')">
                        <div class="nav-icon"></div>
                        商户开户
                    </li>
                    <li class="nav-item" onclick="showPage('account-info')">
                        <div class="nav-icon"></div>
                        管理账号
                    </li>
                    <li class="nav-item" onclick="showPage('products')">
                        <div class="nav-icon"></div>
                        管理商品
                    </li>
                    <li class="nav-item" onclick="showPage('activities')">
                        <div class="nav-icon"></div>
                        管理活动
                    </li>
                    <li class="nav-item" onclick="showPage('service-providers')">
                        <div class="nav-icon"></div>
                        管理服务商
                    </li>
                    <li class="nav-item" onclick="showPage('orders')">
                        <div class="nav-icon"></div>
                        管理订单
                    </li>
                    <li class="nav-item" onclick="showPage('sales')">
                        <div class="nav-icon"></div>
                        销售情况
                    </li>
                    <li class="nav-item" onclick="showPage('after-sales')">
                        <div class="nav-icon"></div>
                        管理售后
                    </li>
                `;
            }
        }

        // 设置侧边栏的激活项
        function setActiveNavForPage(pageId) {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            if (!currentUser || !currentUser.role) return;
            // 平台管理员页面归属
            if (currentUser.role === 'platform-admin') {
                const mapping = {
                    'admin-merchants': ['admin-merchants','admin-merchant-approve-open','admin-merchant-approve-change','admin-merchant-suspend','admin-merchant-resume'],
                    'admin-products': ['admin-products','admin-product-approve-new','admin-product-approve-change','admin-product-category-create','admin-product-category-delete','admin-product-category-update','admin-product-query'],
                    'admin-customers': ['admin-customers','admin-customer-ban','admin-customer-unban','admin-customer-query','admin-customer-deactivate'],
                    'admin-providers': ['admin-providers','admin-provider-approve-open','admin-provider-approve-change','admin-provider-query','admin-provider-suspend','admin-provider-resume'],
                    'admin-activities': ['admin-activities','admin-activity-approve','admin-activity-query']
                };
                for (const [navKey, pages] of Object.entries(mapping)) {
                    if (pages.includes(pageId)) {
                        const target = Array.from(navItems).find(li => li.getAttribute('data-nav') === navKey);
                        if (target) target.classList.add('active');
                        break;
                    }
                }
            } else {
                // 原有规则
                if (pageId === 'account-opening') {
                    navItems[0] && navItems[0].classList.add('active');
                } else if (['account-info','modify-account','modify-attributes','account-cancellation','suspend-account','cancel-account'].includes(pageId)) {
                    navItems[1] && navItems[1].classList.add('active');
                } else if (['products','product-search-results','apply-new-product','apply-product-change','query-product','modify-product-attributes'].includes(pageId)) {
                    navItems[2] && navItems[2].classList.add('active');
                }
            }
        }

        // 绑定全局搜索（Enter 触发跳转）
        function attachGlobalSearch() {
            const input = document.getElementById('globalSearchInput');
            if (!input) return;
            input.onkeydown = (e) => {
                if (e.key === 'Enter') {
                    const q = (input.value || '').trim();
                    if (!q) return;
                    if (currentUser && currentUser.role === 'platform-admin') {
                        routeAdminSearch(q);
                    } else {
                        // 非平台管理员：若在商品页，沿用现有搜索逻辑
                        if (document.getElementById('products') && document.getElementById('products').classList.contains('active')) {
                            const productInput = document.getElementById('productSearchInput');
                            if (productInput) productInput.value = q;
                            searchProducts();
                        } else {
                            showModal('info', '全局搜索', '请在当前页面使用对应的搜索功能。', '🔍');
                        }
                    }
                }
            };
        }

        // 平台管理员的搜索路由
        function routeAdminSearch(query) {
            const q = query.replace(/\s+/g, '').toLowerCase();
            const goto = (id) => showPage(id);

            // 关键字匹配工具
            const has = (w) => q.includes(w);

            // 商户
            if ((has('审核') && has('商户') && (has('开户') || has('开店') || has('开设'))) ) return goto('admin-merchant-approve-open');
            if ((has('审核') && has('商户') && (has('变更') || has('修改') || has('变动'))) ) return goto('admin-merchant-approve-change');
            if ((has('暂停') || has('停用')) && has('商户')) return goto('admin-merchant-suspend');
            if ((has('恢复') || has('启用')) && has('商户')) return goto('admin-merchant-resume');

            // 商品
            if (has('审核') && (has('新增商品') || (has('新增') && has('商品')))) return goto('admin-product-approve-new');
            if (has('审核') && (has('变更商品') || (has('变更') && has('商品')))) return goto('admin-product-approve-change');
            if ((has('建立') || has('新增') || has('创建')) && has('商品分类')) return goto('admin-product-category-create');
            if (has('删除') && has('商品分类')) return goto('admin-product-category-delete');
            if ((has('修改') || has('编辑')) && has('商品分类')) return goto('admin-product-category-update');
            if (has('查询') && has('商品')) return goto('admin-product-query');

            // 顾客
            if ((has('封禁') || has('禁用')) && (has('顾客') || has('用户'))) return goto('admin-customer-ban');
            if ((has('解禁') || has('启用')) && (has('顾客') || has('用户'))) return goto('admin-customer-unban');
            if ((has('查询')) && (has('顾客') || has('用户'))) return goto('admin-customer-query');
            if ((has('注销') || has('删除')) && (has('顾客') || has('用户'))) return goto('admin-customer-deactivate');

            // 服务商
            if (has('审核') && has('服务商') && (has('开户') || has('开通'))) return goto('admin-provider-approve-open');
            if (has('审核') && has('服务商') && (has('变更') || has('修改'))) return goto('admin-provider-approve-change');
            if (has('查询') && has('服务商')) return goto('admin-provider-query');
            if ((has('暂停') || has('停用')) && has('服务商')) return goto('admin-provider-suspend');
            if ((has('恢复') || has('启用')) && has('服务商')) return goto('admin-provider-resume');

            // 活动
            if (has('审核') && has('活动')) return goto('admin-activity-approve');
            if (has('查询') && has('活动')) return goto('admin-activity-query');

            // 默认：跳到平台管理员主页
            showModal('info', '未匹配到页面', '未识别的关键词，已为您打开平台管理员导航。', '🔎');
            goto('admin-merchants');
        }

        // 提交开户申请
        function submitAccountOpening() {
            // 获取表单数据
            const merchantName = document.getElementById('merchantName').value.trim();
            const contactName = document.getElementById('contactName').value.trim();
            const contactPhone = document.getElementById('contactPhone').value.trim();
            const merchantAddress = document.getElementById('merchantAddress').value.trim();
            const productLimit = document.getElementById('productLimit').value.trim();
            const employeeLimit = document.getElementById('employeeLimit').value.trim();
            
            // 表单验证
            if (!merchantName || !contactName || !contactPhone || !merchantAddress || !productLimit || !employeeLimit) {
                showModal('warning', '请填写完整信息', '请确保所有必填字段都已填写完整。', '⚠');
                return;
            }
            
            // 验证数字字段
            if (isNaN(productLimit) || isNaN(employeeLimit) || productLimit <= 0 || employeeLimit <= 0) {
                showModal('warning', '数据格式错误', '商品数目上限和员工上限必须为正整数。', '⚠');
                return;
            }
            
            // 验证手机号格式（简单验证）
            const phoneRegex = /^1[3-9]\d{9}$/;
            if (!phoneRegex.test(contactPhone)) {
                showModal('warning', '手机号格式错误', '请输入正确的手机号码格式。', '⚠');
                return;
            }
            
            // 显示成功弹窗
            showModal('success', '开户申请提交成功', '您的开户申请已成功提交，请等待平台审核。审核结果将通过系统消息通知您。', '✓');
            setTimeout(() => {
                hideModal();
                showPage('account-info');
            }, 2000);
        }

        // 提交销户申请
        function submitAccountCancellation() {
            // 显示确认弹窗
            showModal('danger', '确认注销账户', '您确定要注销账户吗？此操作不可逆，所有数据将被永久删除。', '⚠');
            
            // 更新按钮
            const confirmBtn = document.getElementById('modalConfirmBtn');
            confirmBtn.textContent = '确认注销';
            confirmBtn.className = 'modal-btn modal-btn-secondary';
            confirmBtn.onclick = function() {
                hideModal();
                // 显示成功弹窗
                setTimeout(() => {
                    showModal('warning', '注销申请提交成功', '您的账户注销申请已成功提交，请等待平台审核。请注意：此操作一旦审核通过将不可逆。', '⚠');
                    setTimeout(() => {
                        hideModal();
                        showPage('account-info');
                    }, 2000);
                }, 300);
            };
            
            // 添加取消按钮
            const modalButtons = document.querySelector('.modal-buttons');
            if (!document.getElementById('modalCancelBtn')) {
                const cancelBtn = document.createElement('button');
                cancelBtn.id = 'modalCancelBtn';
                cancelBtn.className = 'modal-btn modal-btn-primary';
                cancelBtn.textContent = '取消';
                cancelBtn.onclick = function() {
                    hideModal();
                    // 重置按钮
                    confirmBtn.textContent = '确定';
                    confirmBtn.className = 'modal-btn modal-btn-primary';
                    confirmBtn.onclick = hideModal;
                    cancelBtn.remove();
                };
                modalButtons.appendChild(cancelBtn);
            }
        }

        // 提交账户修改
        function submitAccountModification() {
            showModal('success', '账户信息修改成功', '您的账户信息修改申请已成功提交，请等待平台审核。审核通过后修改将生效。', '✓');
            setTimeout(() => {
                hideModal();
                showPage('account-info');
            }, 2000);
        }

        // 提交属性修改
        function submitAttributeModification() {
            showModal('success', '账户属性修改成功', '您的账户属性修改已成功提交，请等待平台审核。审核通过后修改将生效。', '✓');
            setTimeout(() => {
                hideModal();
                showPage('account-info');
            }, 2000);
        }

        // 提交账户暂停
        function submitAccountSuspension() {
            showModal('warning', '账户暂停申请提交成功', '您的账户暂停申请已成功提交，请等待平台审核。暂停期间您的账户将无法正常使用。', '⚠');
            setTimeout(() => {
                hideModal();
                showPage('account-info');
            }, 2000);
        }

        // 商品管理相关函数
        function toggleBundleOptions(show) {
            const bundleOptions = document.getElementById('bundleOptions');
            bundleOptions.style.display = show ? 'block' : 'none';
        }

        function searchProducts() {
            const searchInput = document.getElementById('productSearchInput').value.trim();
            if (searchInput) {
                // 跳转到搜索结果页面
                showPage('product-search-results');
                // 更新搜索结果页面的搜索框
                document.getElementById('searchResultsInput').value = searchInput;
            } else {
                showModal('warning', '请输入搜索关键词', '请在搜索框中输入商品名称或编号。', '⚠');
            }
        }

        function searchProductsFromResults() {
            const searchInput = document.getElementById('searchResultsInput').value.trim();
            if (searchInput) {
                showModal('success', '搜索完成', `正在搜索包含"${searchInput}"的商品...`, '🔍');
                // 这里可以更新搜索结果
            } else {
                showModal('warning', '请输入搜索关键词', '请在搜索框中输入商品名称或编号。', '⚠');
            }
        }


        function deleteProduct(productId) {
            if (confirm(`确定要删除商品 ${productId} 吗？`)) {
                showModal('success', '删除成功', `商品 ${productId} 已删除。`, '✓');
            }
        }

        function changePage(direction) {
            showModal('info', '分页功能', '分页功能演示', '📄');
        }

        function submitNewProduct() {
            const productName = document.getElementById('productName').value.trim();
            const productCategory = document.getElementById('productCategory').value;
            const originalPrice = document.getElementById('originalPrice').value.trim();
            const unit = document.getElementById('unit').value.trim();
            const origin = document.getElementById('origin').value.trim();
            const barcode = document.getElementById('barcode').value.trim();
            const revenueShareRatio = document.getElementById('revenueShareRatio').value.trim();
            
            if (!productName || !productCategory || !originalPrice || !unit || !origin || !barcode || !revenueShareRatio) {
                showModal('warning', '请填写完整信息', '请确保所有必填字段都已填写完整。', '⚠');
                return;
            }
            
            showModal('success', '申请提交成功', '您的新增商品申请已成功提交，请等待平台审核。', '✓');
            setTimeout(() => {
                hideModal();
                showPage('products');
            }, 2000);
        }

        function submitProductChange() {
            const selectedProduct = document.getElementById('changeProductSelect').value;
            if (!selectedProduct) {
                showModal('warning', '请选择商品', '请先选择要变更的商品。', '⚠');
                return;
            }
            
            showModal('success', '变更申请提交成功', '您的商品变更申请已成功提交，请等待平台审核。', '✓');
            setTimeout(() => {
                hideModal();
                showPage('products');
            }, 2000);
        }

        function queryProducts() {
            const productName = document.getElementById('queryProductName').value.trim();
            const barcode = document.getElementById('queryBarcode').value.trim();
            
            if (!productName && !barcode) {
                showModal('warning', '请输入查询条件', '请输入商品名称或条码进行查询。', '⚠');
                return;
            }
            
            // 模拟查询结果
            const queryResults = document.getElementById('queryResults');
            const queryResultsBody = document.getElementById('queryResultsBody');
            
            queryResultsBody.innerHTML = `
                <tr>
                    <td>iPhone 15 Pro</td>
                    <td>电子产品</td>
                    <td>¥8,999</td>
                    <td>台</td>
                    <td>中国</td>
                    <td>1234567890123</td>
                    <td>15%</td>
                    <td><button class="btn-edit" onclick="viewProductDetails('P001')">查看详情</button></td>
                </tr>
            `;
            
            queryResults.style.display = 'block';
            showModal('success', '查询完成', '找到匹配的商品信息。', '✓');
        }

        function viewProductDetails(productId) {
            showModal('info', '商品详情', `正在查看商品 ${productId} 的详细信息...`, '👁️');
        }

        function submitProductAttributes() {
            const selectedProduct = document.getElementById('modifyProductSelect').value;
            if (!selectedProduct) {
                showModal('warning', '请选择商品', '请先选择要修改的商品。', '⚠');
                return;
            }
            
            showModal('success', '属性修改成功', '商品属性修改已成功提交。', '✓');
            setTimeout(() => {
                hideModal();
                showPage('products');
            }, 2000);
        }

        // 维修工页面切换与导航
        function showTechPage(pageId) {
            const pages = document.querySelectorAll('#techApp .page');
            pages.forEach(p => p.classList.remove('active'));
            const target = document.getElementById(pageId);
            if (target) target.classList.add('active');

            const items = document.querySelectorAll('#techApp .nav-item');
            items.forEach(i => i.classList.remove('active'));
            if (pageId === 'tech-orders') items[0].classList.add('active');
            if (pageId === 'tech-order-detail') items[1].classList.add('active');
        }

        // 搜索栏导航（PC）
        function techSearchNavigate() {
            const kw = (document.getElementById('techSearchInput').value || '').trim();
            if (kw.includes('详情')) {
                showTechPage('tech-order-detail');
            } else {
                // 默认跳转到服务单列表
                showTechPage('tech-orders');
            }
        }

        // 移动端视图切换
        function switchToTechMobile() {
            document.getElementById('techApp').style.display = 'none';
            document.getElementById('techMobile').style.display = 'block';
        }
        function switchToTechPC() {
            document.getElementById('techMobile').style.display = 'none';
            document.getElementById('techApp').style.display = 'flex';
        }
        function backToTechPC(){switchToTechPC();}

        // 移动端搜索导航
        function techMobileSearchNavigate() {
            const kw = (document.getElementById('techMobileSearch').value || '').trim();
            if (kw.includes('详情')) {
                showTechMobilePage('detail');
            } else {
                showTechMobilePage('list');
            }
        }

        // 查看/接收/拒绝服务单
        function viewTechOrder(orderId) {
            document.getElementById('detailOrderId').value = orderId;
            showTechPage('tech-order-detail');
        }
        function viewTechOrderMobile(orderId) {
            document.getElementById('techMobileDetailId').value = orderId;
            showTechMobilePage('detail');
        }
        function acceptTechOrder(orderId) {
            showModal('success', '接收成功', `服务单 ${orderId} 接收成功。`, '✓');
        }
        function rejectTechOrder(orderId) {
            // 简单输入理由
            const reason = prompt(`请输入拒绝服务单 ${orderId} 的理由：`);
            if (reason && reason.trim()) {
                showModal('warning', '已拒绝', `已拒绝服务单 ${orderId}。系统将通知商户重新派单。`, '⚠');
            }
        }

        function showTechMobilePage(which) {
            const list = document.getElementById('techMobileList');
            const detail = document.getElementById('techMobileDetail');
            if (which === 'detail') {
                list.style.display = 'none';
                detail.style.display = 'block';
            } else {
                detail.style.display = 'none';
                list.style.display = 'block';
            }
        }

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            // 默认显示登录页面
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('techApp').style.display = 'none';
            document.getElementById('techMobile').style.display = 'none';
        });

        

        /* ======================= 平台管理员页面与交互 ======================= */
        // 公共的“提交/审核”演示函数
        function adminSubmitSuccess(message, backPageId) {
            showModal('success', '操作成功', message || '操作已完成。', '✓');
            setTimeout(() => {
                hideModal();
                if (backPageId) showPage(backPageId);
            }, 1500);
        }

        function adminReview(actionDesc) {
            showModal('success', '审核已提交', actionDesc || '审核已提交。', '✓');
        }

        // 查询页面：绑定输入框的回车展示结果
        function bindEnterToShowResults(inputId, tableBodyId) {
            const input = document.getElementById(inputId);
            if (!input) return;
            input.onkeydown = (e) => {
                if (e.key === 'Enter') {
                    const val = input.value.trim();
                    if (!val) return;
                    const tbody = document.getElementById(tableBodyId);
                    if (tbody) {
                        tbody.innerHTML = `
                            <tr>
                                <td>${val}</td>
                                <td>示例对象</td>
                                <td>正常</td>
                                <td><button class="btn-edit" onclick="showModal('info','详情','查看 ${val} 的详情','👁️')">查看</button></td>
                            </tr>
                        `;
                    }
                    showModal('success','查询完成','已根据关键字展示结果。','✓');
                }
            };
        }

        function updateList(elementId, items) {
            const container = document.getElementById(elementId);
            if (!container) return;
            if (!items || items.length === 0) {
                container.innerHTML = '<li>暂无数据</li>';
                return;
            }
            container.innerHTML = items.map(item => `<li>${item}</li>`).join('');
        }

        function renderProviderQueryResults(rows) {
            const tbody = document.getElementById('adminProviderQueryBody');
            if (!tbody) return;
            if (!rows || rows.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#888;">未找到匹配的服务商</td></tr>';
                return;
            }
            tbody.innerHTML = rows.map(r => `
                <tr data-id="${r.id}">
                    <td>${r.id}</td>
                    <td>${r.name}</td>
                    <td>${Array.isArray(r.types) ? r.types.join('、') : r.types}</td>
                    <td>${r.region}</td>
                    <td class="action-buttons"><button class="btn-edit" onclick="selectProviderQuery('${r.id}')">查看详情</button></td>
                </tr>
            `).join('');
        }

        function searchProviderList() {
            const name = (document.getElementById('adminProviderQueryInput')?.value || '').trim();
            const type = document.getElementById('adminProviderTypeSelect')?.value || '';
            const region = (document.getElementById('adminProviderRegionInput')?.value || '').trim();
            const all = adminMockData.providerSearch || [];
            const q = (s) => s && s.replace(/\s+/g,'').toLowerCase();
            const nameQ = q(name), regionQ = q(region), typeQ = q(type);
            const rows = all.filter(p => {
                const okName = !nameQ || q(p.name).includes(nameQ);
                const okRegion = !regionQ || q(p.region).includes(regionQ);
                const typesText = Array.isArray(p.types) ? p.types.join('/') : (p.types || '');
                const okType = !typeQ || q(typesText).includes(typeQ);
                return okName && okType && okRegion;
            });
            renderProviderQueryResults(rows);
            if (rows.length) { selectProviderQuery(rows[0].id); }
            showModal('success','查询完成','已根据条件展示服务商列表。','✓');
        }

        function selectProviderQuery(id) {
            const all = adminMockData.providerSearch || [];
            const data = all.find(p => p.id === id);
            adminSelections.providerQuery = data ? id : null;
            document.getElementById('providerQueryName').textContent = data ? data.name : '-';
            document.getElementById('providerQueryTypes').textContent = data ? (Array.isArray(data.types)? data.types.join('、') : data.types) : '-';
            document.getElementById('providerQueryRegion').textContent = data ? data.region : '-';
            document.getElementById('providerQueryContactName').textContent = data ? data.contactName : '-';
            document.getElementById('providerQueryContactPhone').textContent = data ? data.contactPhone : '-';
            document.getElementById('providerQueryContactAddress').textContent = data ? data.contactAddress : '-';
            document.getElementById('providerQueryIntro').textContent = data ? data.intro : '-';
            updateList('providerQueryQualifications', data ? data.qualifications : []);
            // 行选中样式
            const rows = document.querySelectorAll('#adminProviderQueryBody tr');
            rows.forEach(row => row.classList.toggle('selected', row.getAttribute('data-id') === id));
        }

        function selectMerchantOpen(id) {
            const rows = document.querySelectorAll('#merchantOpenTable tbody tr');
            rows.forEach(row => row.classList.toggle('selected', row.dataset.id === id));
            const data = adminMockData.merchantOpen[id];
            adminSelections.merchantOpen = data ? id : null;
            document.getElementById('merchantOpenCurrentId').textContent = data ? data.id : '请选择申请';
            document.getElementById('merchantOpenName').textContent = data ? data.merchantName : '-';
            document.getElementById('merchantOpenContact').textContent = data ? data.contact : '-';
            document.getElementById('merchantOpenPhone').textContent = data ? data.phone : '-';
            document.getElementById('merchantOpenScope').textContent = data ? data.scope : '-';
            document.getElementById('merchantOpenRegion').textContent = data ? data.region : '-';
            document.getElementById('merchantOpenAddress').textContent = data ? data.address : '-';
            document.getElementById('merchantOpenShare').textContent = data ? data.share : '-';
            document.getElementById('merchantOpenLicense').textContent = data ? data.licenseNo : '-';
            document.getElementById('merchantOpenLicenseValid').textContent = data ? data.licenseValid : '-';
            document.getElementById('merchantOpenBank').textContent = data ? data.bank : '-';
            document.getElementById('merchantOpenSubmit').textContent = data ? data.submitTime : '-';
            document.getElementById('merchantOpenRemark').textContent = data ? data.remark : '-';
            updateList('merchantOpenAttachments', data ? data.attachments : []);
        }

        function selectMerchantChange(id) {
            const rows = document.querySelectorAll('#merchantChangeTable tbody tr');
            rows.forEach(row => row.classList.toggle('selected', row.dataset.id === id));
            const data = adminMockData.merchantChange[id];
            adminSelections.merchantChange = data ? id : null;
            document.getElementById('merchantChangeCurrentId').textContent = data ? data.id : '请选择变更申请';
            document.getElementById('merchantChangeName').textContent = data ? data.merchantName : '-';
            document.getElementById('merchantChangeContact').textContent = data ? data.contact : '-';
            document.getElementById('merchantChangePhone').textContent = data ? data.phone : '-';
            document.getElementById('merchantChangeSubmit').textContent = data ? data.submitTime : '-';
            document.getElementById('merchantChangeAttachments').textContent = data && data.attachments ? data.attachments.join('，') : '-';
            const diffList = data && data.diffs ? data.diffs.map(item => `${item.field}：${item.oldValue} → ${item.newValue}`) : [];
            updateList('merchantChangeDiff', diffList);
        }

        function selectProductNew(id) {
            const rows = document.querySelectorAll('#productNewTable tbody tr');
            rows.forEach(row => row.classList.toggle('selected', row.dataset.id === id));
            const data = adminMockData.productNew[id];
            adminSelections.productNew = data ? id : null;
            document.getElementById('productNewCurrentId').textContent = data ? data.id : '请选择商品';
            document.getElementById('productNewName').textContent = data ? data.name : '-';
            document.getElementById('productNewShop').textContent = data ? data.shop : '-';
            document.getElementById('productNewCategory').textContent = data ? data.category : '-';
            document.getElementById('productNewOriginal').textContent = data ? data.originalPrice : '-';
            document.getElementById('productNewPrice').textContent = data ? data.salePrice : '-';
            document.getElementById('productNewUnit').textContent = data ? data.unit : '-';
            document.getElementById('productNewOrigin').textContent = data ? data.origin : '-';
            document.getElementById('productNewBarcode').textContent = data ? data.barcode : '-';
            document.getElementById('productNewShare').textContent = data ? data.share : '-';
            document.getElementById('productNewShareCategory').textContent = data ? data.shareCategory : '-';
            document.getElementById('productNewSubmit').textContent = data ? data.submitTime : '-';
            document.getElementById('productNewRemark').textContent = data ? data.remark : '-';
            updateList('productNewAttachments', data ? data.attachments : []);
        }

        function selectProductChange(id) {
            const rows = document.querySelectorAll('#productChangeTable tbody tr');
            rows.forEach(row => row.classList.toggle('selected', row.dataset.id === id));
            const data = adminMockData.productChange[id];
            adminSelections.productChange = data ? id : null;
            document.getElementById('productChangeCurrentId').textContent = data ? data.id : '请选择变更项';
            document.getElementById('productChangeName').textContent = data ? data.name : '-';
            document.getElementById('productChangeShop').textContent = data ? data.shop : '-';
            document.getElementById('productChangeCategory').textContent = data ? data.category : '-';
            document.getElementById('productChangePrice').textContent = data ? data.price : '-';
            document.getElementById('productChangeShare').textContent = data ? data.share : '-';
            document.getElementById('productChangeSubmit').textContent = data ? data.submitTime : '-';
            updateList('productChangeAttachments', data ? data.attachments : []);
            const diffList = data && data.diffs ? data.diffs.map(item => `${item.field}：${item.oldValue} → ${item.newValue}`) : [];
            updateList('productChangeDiff', diffList);
        }

        function selectProviderOpen(id) {
            const rows = document.querySelectorAll('#providerOpenTable tbody tr');
            rows.forEach(row => row.classList.toggle('selected', row.dataset.id === id));
            const data = adminMockData.providerOpen[id];
            adminSelections.providerOpen = data ? id : null;
            document.getElementById('providerOpenCurrentId').textContent = data ? data.id : '请选择申请';
            document.getElementById('providerOpenName').textContent = data ? data.providerName : '-';
            document.getElementById('providerOpenContact').textContent = data ? data.contact : '-';
            document.getElementById('providerOpenPhone').textContent = data ? data.phone : '-';
            document.getElementById('providerOpenScope').textContent = data ? data.scope : '-';
            document.getElementById('providerOpenRegion').textContent = data ? data.region : '-';
            document.getElementById('providerOpenAddress').textContent = data ? data.address : '-';
            document.getElementById('providerOpenLicense').textContent = data ? data.licenseNo : '-';
            document.getElementById('providerOpenLicenseValid').textContent = data ? data.licenseValid : '-';
            document.getElementById('providerOpenBank').textContent = data ? data.bank : '-';
            document.getElementById('providerOpenSubmit').textContent = data ? data.submitTime : '-';
            document.getElementById('providerOpenRemark').textContent = data ? data.remark : '-';
            updateList('providerOpenAttachments', data ? data.attachments : []);
        }

        function selectProviderChange(id) {
            const rows = document.querySelectorAll('#providerChangeTable tbody tr');
            rows.forEach(row => row.classList.toggle('selected', row.dataset.id === id));
            const data = adminMockData.providerChange[id];
            adminSelections.providerChange = data ? id : null;
            document.getElementById('providerChangeCurrentId').textContent = data ? data.id : '请选择变更申请';
            document.getElementById('providerChangeName').textContent = data ? data.providerName : '-';
            document.getElementById('providerChangeContact').textContent = data ? data.contact : '-';
            document.getElementById('providerChangePhone').textContent = data ? data.phone : '-';
            document.getElementById('providerChangeSubmit').textContent = data ? data.submitTime : '-';
            document.getElementById('providerChangeAttachments').textContent = data && data.attachments ? data.attachments.join('，') : '-';
            const diffList = data && data.diffs ? data.diffs.map(item => `${item.field}：${item.oldValue} → ${item.newValue}`) : [];
            updateList('providerChangeDiff', diffList);
        }

        function selectActivityApprove(id) {
            const rows = document.querySelectorAll('#activityApproveTable tbody tr');
            rows.forEach(row => row.classList.toggle('selected', row.dataset.id === id));
            const data = adminMockData.activityApprove[id];
            adminSelections.activityReview = data ? id : null;
            document.getElementById('activityCurrentId').textContent = data ? data.id : '请选择活动';
            document.getElementById('activityName').textContent = data ? data.name : '-';
            document.getElementById('activitySponsor').textContent = data ? data.sponsor : '-';
            document.getElementById('activityStart').textContent = data ? data.startTime : '-';
            document.getElementById('activityEnd').textContent = data ? data.endTime : '-';
            document.getElementById('activityScope').textContent = data ? data.scope : '-';
            document.getElementById('activitySubmit').textContent = data ? data.submitTime : '-';
            document.getElementById('activityRemark').textContent = data ? data.remark : '-';
            updateList('activityAttachments', data ? data.attachments : []);
        }

        function ensureSelectionDefaults(pageId) {
            if (pageId === 'admin-merchant-approve-open' && !adminSelections.merchantOpen) {
                const first = Object.keys(adminMockData.merchantOpen)[0];
                if (first) selectMerchantOpen(first);
            }
            if (pageId === 'admin-merchant-approve-change' && !adminSelections.merchantChange) {
                const first = Object.keys(adminMockData.merchantChange)[0];
                if (first) selectMerchantChange(first);
            }
            if (pageId === 'admin-product-approve-new' && !adminSelections.productNew) {
                const first = Object.keys(adminMockData.productNew)[0];
                if (first) selectProductNew(first);
            }
            if (pageId === 'admin-product-approve-change' && !adminSelections.productChange) {
                const first = Object.keys(adminMockData.productChange)[0];
                if (first) selectProductChange(first);
            }
            if (pageId === 'admin-provider-approve-open' && !adminSelections.providerOpen) {
                const first = Object.keys(adminMockData.providerOpen)[0];
                if (first) selectProviderOpen(first);
            }
            if (pageId === 'admin-provider-approve-change' && !adminSelections.providerChange) {
                const first = Object.keys(adminMockData.providerChange)[0];
                if (first) selectProviderChange(first);
            }
            if (pageId === 'admin-activity-approve' && !adminSelections.activityReview) {
                const first = Object.keys(adminMockData.activityApprove)[0];
                if (first) selectActivityApprove(first);
            }
        }

        function submitAdminOutcome(context, entityId, action, reason, backPageId) {
            if (!entityId) {
                showModal('warning', '请先选择对象', '请从列表中选择一条记录后再提交操作。', '⚠');
                return;
            }
            const actionText = action === 'approved' ? '审核通过' : '审核未通过';
            const type = action === 'approved' ? 'success' : 'warning';
            let message = `${context} ${entityId} ${actionText}`;
            if (reason) {
                message += `。原因：${reason}`;
            }
            showModal(type, '操作已提交', message, action === 'approved' ? '✓' : '⚠');
            setTimeout(() => {
                hideModal();
                if (backPageId) {
                    showPage(backPageId);
                }
            }, 1500);
        }

        function submitMerchantOpenDecision(action) {
            const reasonField = document.getElementById('merchantOpenRejectReason');
            const reason = reasonField ? reasonField.value.trim() : '';
            if (action === 'rejected' && !reason) {
                showModal('warning', '请填写驳回原因', '驳回商户开户申请时必须说明原因。', '⚠');
                return;
            }
            submitAdminOutcome('商户开户申请', adminSelections.merchantOpen, action, reason, 'admin-merchants');
            if (reasonField && action === 'approved') {
                reasonField.value = '';
            }
        }

        function submitMerchantChangeDecision(action) {
            const reasonField = document.getElementById('merchantChangeRejectReason');
            const reason = reasonField ? reasonField.value.trim() : '';
            if (action === 'rejected' && !reason) {
                showModal('warning', '请填写驳回原因', '驳回商户变更申请时必须说明原因。', '⚠');
                return;
            }
            submitAdminOutcome('商户变更申请', adminSelections.merchantChange, action, reason, 'admin-merchants');
            if (reasonField && action === 'approved') {
                reasonField.value = '';
            }
        }

        function submitProductNewDecision(action) {
            const reasonField = document.getElementById('productNewRejectReason');
            const reason = reasonField ? reasonField.value.trim() : '';
            if (action === 'rejected' && !reason) {
                showModal('warning', '请填写驳回原因', '驳回新增商品申请时必须说明原因。', '⚠');
                return;
            }
            submitAdminOutcome('新增商品申请', adminSelections.productNew, action, reason, 'admin-products');
            if (reasonField && action === 'approved') {
                reasonField.value = '';
            }
        }

        function submitProductChangeDecision(action) {
            const reasonField = document.getElementById('productChangeRejectReason');
            const reason = reasonField ? reasonField.value.trim() : '';
            if (action === 'rejected' && !reason) {
                showModal('warning', '请填写驳回原因', '驳回商品变更申请时必须说明原因。', '⚠');
                return;
            }
            submitAdminOutcome('商品变更申请', adminSelections.productChange, action, reason, 'admin-products');
            if (reasonField && action === 'approved') {
                reasonField.value = '';
            }
        }

        function submitProviderOpenDecision(action) {
            const reasonField = document.getElementById('providerOpenRejectReason');
            const reason = reasonField ? reasonField.value.trim() : '';
            if (action === 'rejected' && !reason) {
                showModal('warning', '请填写驳回原因', '驳回时必须填写原因。', '⚠');
                return;
            }
            submitAdminOutcome('服务商开户申请', adminSelections.providerOpen, action, reason, 'admin-providers');
            if (reasonField && action === 'approved') reasonField.value = '';
        }

        function submitProviderChangeDecision(action) {
            const reasonField = document.getElementById('providerChangeRejectReason');
            const reason = reasonField ? reasonField.value.trim() : '';
            if (action === 'rejected' && !reason) {
                showModal('warning', '请填写驳回原因', '驳回时必须填写原因。', '⚠');
                return;
            }
            submitAdminOutcome('服务商变更申请', adminSelections.providerChange, action, reason, 'admin-providers');
            if (reasonField && action === 'approved') reasonField.value = '';
        }

        function submitActivityDecision(action) {
            const reasonField = document.getElementById('activityRejectReason');
            const reason = reasonField ? reasonField.value.trim() : '';
            if (action === 'rejected' && !reason) {
                showModal('warning', '请填写驳回原因', '驳回时必须填写原因。', '⚠');
                return;
            }
            submitAdminOutcome('活动审核', adminSelections.activityReview, action, reason, 'admin-activities');
            if (reasonField && action === 'approved') reasonField.value = '';
        }

        function renderMerchantResults(rows, containerId, actionType) {
            const tbody = document.querySelector(`#${containerId} tbody`);
            if (!tbody) return;
            if (!rows || rows.length === 0) {
                tbody.innerHTML = `<tr><td colspan="7" style="text-align:center; color:#777;">未检索到符合条件的商户</td></tr>`;
                return;
            }
            tbody.innerHTML = rows.map(row => `
                <tr>
                    <td>${row.name}</td>
                    <td>${row.contact}</td>
                    <td>${row.phone}</td>
                    <td>${row.region}</td>
                    <td>${row.address}</td>
                    <td>${row.status}</td>
                    <td class="action-buttons">
                        <button class="btn-${actionType === 'suspend' ? 'warning' : 'primary'}" onclick="handleMerchantStatus('${actionType}','${row.id}','${row.name}')">${actionType === 'suspend' ? '暂停商户' : '恢复营业'}</button>
                    </td>
                </tr>
            `).join('');
        }

        function searchMerchantList(type) {
            const dataset = adminMockData.merchantSearch[type] || [];
            if (type === 'suspend') {
                renderMerchantResults(dataset, 'merchantSuspendResult', 'suspend');
            } else {
                renderMerchantResults(dataset, 'merchantResumeResult', 'resume');
            }
            showModal('success', '检索完成', '已根据查询条件展示商户列表，可继续执行操作。', '✓');
        }

        function handleMerchantStatus(action, merchantId, merchantName) {
            const context = action === 'suspend' ? '暂停商户' : '恢复商户';
            const message = action === 'suspend'
                ? `已对商户 ${merchantName} (${merchantId}) 暂停营业。该商户所有商品将停止销售，售后流程保持正常。`
                : `已恢复商户 ${merchantName} (${merchantId}) 的营业权限，所有商品同步恢复销售。`;
            const type = action === 'suspend' ? 'warning' : 'success';
            showModal(type, context, message, action === 'suspend' ? '⚠' : '✓');
        }

        /* ======================= 商品分类（修改） ======================= */
        const categoryState = { l1: null, l2: null };

        function renderCategoryL1() {
            const tbody = document.getElementById('categoryL1Body');
            if (!tbody) return;
            const level1 = (adminMockData.productCategories && adminMockData.productCategories.level1) || [];
            if (!level1.length) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:#888;">暂无一级分类</td></tr>';
                return;
            }
            tbody.innerHTML = level1.map(c => `
                <tr data-id="${c.id}">
                    <td>${c.id}</td>
                    <td>${c.name}</td>
                    <td>${c.share}</td>
                    <td class="action-buttons"><button class="btn btn-edit" onclick="selectCategoryL1('${c.id}')">选择</button></td>
                </tr>
            `).join('');
            // 保持之前选择
            if (categoryState.l1) selectCategoryL1(categoryState.l1);
        }

        function selectCategoryL1(id) {
            const level1 = adminMockData.productCategories.level1 || [];
            const c = level1.find(x => x.id === id);
            categoryState.l1 = c ? c.id : null;
            document.getElementById('catL1Id').value = c ? c.id : '';
            document.getElementById('catL1NameInput').value = c ? c.name : '';
            document.getElementById('catL1ShareInput').value = c ? c.share : '';
            // 高亮
            const rows = document.querySelectorAll('#categoryL1Body tr');
            rows.forEach(r => r.classList.toggle('selected', r.getAttribute('data-id') === id));
            // 渲染二级
            renderCategoryL2(c ? c.children || [] : []);
        }

        function validateDuplicateName(names, newName, currentId, siblings) {
            const target = (newName || '').trim();
            if (!target) return false;
            // 在兄弟节点中查重（忽略当前项）
            return siblings.some(s => s.name === target && s.id !== currentId);
        }

        function saveCategoryL1() {
            const level1 = adminMockData.productCategories.level1 || [];
            const id = document.getElementById('catL1Id').value;
            if (!id) { showModal('warning','请选择分类','请先在上方列表选择一个一级分类。','⚠'); return; }
            const name = document.getElementById('catL1NameInput').value.trim();
            const shareStr = document.getElementById('catL1ShareInput').value.trim();
            const share = Number(shareStr);
            if (!name || shareStr === '' || isNaN(share) || share < 0 || share > 100) {
                showModal('warning','参数不合法','请填写名称，且分账比例为 0-100 的数字。','⚠');
                return;
            }
            if (validateDuplicateName(level1.map(x=>x.name), name, id, level1)) {
                showModal('warning','名称在同一级重复','请更换为该级别中未使用的名称。','⚠');
                return;
            }
            const idx = level1.findIndex(x => x.id === id);
            if (idx >= 0) {
                level1[idx].name = name;
                level1[idx].share = share;
                showModal('success','修改成功','一级分类已修改。','✓');
                renderCategoryL1();
            }
        }

        function renderCategoryL2(children) {
            const tbody = document.getElementById('categoryL2Body');
            if (!tbody) return;
            if (!children || !children.length) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:#888;">该一级分类暂无二级分类</td></tr>';
                document.getElementById('catL2Id').value='';
                document.getElementById('catL2Parent').value='';
                document.getElementById('catL2NameInput').value='';
                document.getElementById('catL2ShareInput').value='';
                categoryState.l2 = null;
                return;
            }
            tbody.innerHTML = children.map(c => `
                <tr data-id="${c.id}">
                    <td>${c.id}</td>
                    <td>${c.name}</td>
                    <td>${c.share}</td>
                    <td class="action-buttons"><button class="btn btn-edit" onclick="selectCategoryL2('${c.id}')">选择</button></td>
                </tr>
            `).join('');
            if (categoryState.l2) selectCategoryL2(categoryState.l2);
        }

        function selectCategoryL2(id) {
            const level1 = adminMockData.productCategories.level1 || [];
            const l1 = level1.find(x => x.id === categoryState.l1);
            const c = l1 && l1.children ? l1.children.find(y => y.id === id) : null;
            categoryState.l2 = c ? c.id : null;
            document.getElementById('catL2Id').value = c ? c.id : '';
            document.getElementById('catL2Parent').value = l1 ? `${l1.id} / ${l1.name}` : '';
            document.getElementById('catL2NameInput').value = c ? c.name : '';
            document.getElementById('catL2ShareInput').value = c ? c.share : '';
            const rows = document.querySelectorAll('#categoryL2Body tr');
            rows.forEach(r => r.classList.toggle('selected', r.getAttribute('data-id') === id));
        }

        function saveCategoryL2() {
            const level1 = adminMockData.productCategories.level1 || [];
            const l1 = level1.find(x => x.id === categoryState.l1);
            if (!l1) { showModal('warning','请选择一级分类','请先在上方选择一个一级分类。','⚠'); return; }
            const id = document.getElementById('catL2Id').value;
            if (!id) { showModal('warning','请选择二级分类','请在列表中选择一个二级分类。','⚠'); return; }
            const name = document.getElementById('catL2NameInput').value.trim();
            const shareStr = document.getElementById('catL2ShareInput').value.trim();
            const share = Number(shareStr);
            if (!name || shareStr === '' || isNaN(share) || share < 0 || share > 100) {
                showModal('warning','参数不合法','请填写名称，且分账比例为 0-100 的数字。','⚠');
                return;
            }
            const siblings = l1.children || [];
            if (validateDuplicateName(siblings.map(x=>x.name), name, id, siblings)) {
                showModal('warning','名称在同一级重复','请更换为该级别中未使用的名称。','⚠');
                return;
            }
            const idx = siblings.findIndex(x => x.id === id);
            if (idx >= 0) {
                siblings[idx].name = name;
                siblings[idx].share = share;
                showModal('success','修改成功','二级分类已修改。','✓');
                renderCategoryL2(l1.children);
            }
        }

        /* ======================= 查询商品（管理员） ======================= */
        function renderAdminProductResults(rows) {
            const tbody = document.getElementById('adminProductQueryBody');
            if (!tbody) return;
            if (!rows || !rows.length) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:#888;">未找到匹配的商品</td></tr>';
                return;
            }
            tbody.innerHTML = rows.map(p => `
                <tr data-id="${p.id}">
                    <td>${p.name}</td>
                    <td>${p.shopName}</td>
                    <td>${p.category}</td>
                    <td>${p.originalPrice.toFixed ? p.originalPrice.toFixed(2) : p.originalPrice}</td>
                    <td>${p.auditNew || '-'}</td>
                    <td>${p.auditChange || '-'}</td>
                    <td class="action-buttons"><button class="btn-edit" onclick="selectAdminProduct('${p.id}')">查看</button></td>
                </tr>
            `).join('');
        }

        function searchAdminProducts() {
            const name = (document.getElementById('adminProductNameInput')?.value || '').trim().toLowerCase();
            const shop = (document.getElementById('adminProductShopInput')?.value || '').trim().toLowerCase();
            const cat = (document.getElementById('adminProductCategoryInput')?.value || '').trim().toLowerCase();
            const all = adminMockData.productSearch || [];
            const rows = all.filter(p => {
                const okName = !name || p.name.toLowerCase().includes(name);
                const okShop = !shop || (p.shopName||'').toLowerCase().includes(shop);
                const okCat = !cat || (p.category||'').toLowerCase().includes(cat);
                return okName && okShop && okCat;
            });
            renderAdminProductResults(rows);
            if (rows.length) selectAdminProduct(rows[0].id);
            showModal('success','查询完成','已显示符合条件的商品信息。','✓');
        }

        function selectAdminProduct(id) {
            const all = adminMockData.productSearch || [];
            const p = all.find(x => x.id === id);
            document.getElementById('adminProdDetailName').textContent = p ? p.name : '-';
            document.getElementById('adminProdDetailShop').textContent = p ? p.shopName : '-';
            document.getElementById('adminProdDetailCategory').textContent = p ? p.category : '-';
            document.getElementById('adminProdDetailOriginal').textContent = p ? (p.originalPrice.toFixed ? '¥'+p.originalPrice.toFixed(2) : p.originalPrice) : '-';
            document.getElementById('adminProdDetailAuditNew').textContent = p ? (p.auditNew || '-') : '-';
            document.getElementById('adminProdDetailAuditChange').textContent = p ? (p.auditChange || '-') : '-';
            // 高亮
            const rows = document.querySelectorAll('#adminProductQueryBody tr');
            rows.forEach(r => r.classList.toggle('selected', r.getAttribute('data-id') === id));
        }

        /* ======================= 活动查询（管理员） ======================= */
        function renderAdminActivityResults(rows) {
            const tbody = document.getElementById('adminActivityQueryBody');
            if (!tbody) return;
            if (!rows || !rows.length) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;color:#888;">没有符合条件的活动</td></tr>';
                return;
            }
            tbody.innerHTML = rows.map(a => `
                <tr data-id="${a.id}">
                    <td>${a.id}</td>
                    <td>${a.name}</td>
                    <td>${a.merchantName}</td>
                    <td>${a.startTime} ~ ${a.endTime}</td>
                    <td>${a.status}</td>
                    <td>${a.audits?.new || '-'}</td>
                    <td>${a.audits?.change || '-'}</td>
                    <td class="action-buttons"><button class="btn-edit" onclick="selectAdminActivity('${a.id}')">查看</button></td>
                </tr>
            `).join('');
        }

        function searchAdminActivities() {
            const get = (id)=> (document.getElementById(id)?.value || '').trim().toLowerCase();
            const name = get('activityNameInput');
            const merchant = get('activityMerchantInput');
            const product = get('activityProductInput');
            const status = get('activityStatusSelect');
            const startStr = (document.getElementById('activityStartInput')?.value || '').trim();
            const endStr = (document.getElementById('activityEndInput')?.value || '').trim();
            const start = startStr ? new Date(startStr) : null;
            const end = endStr ? new Date(endStr) : null;
            const all = adminMockData.activities || [];
            const toDate = (s)=> new Date(s.replace(/\-/g,'/'));
            const rows = all.filter(a => {
                const okName = !name || a.name.toLowerCase().includes(name);
                const okMerchant = !merchant || a.merchantName.toLowerCase().includes(merchant);
                const okStatus = !status || a.status.toLowerCase().includes(status);
                const okProd = !product || (a.productNames||[]).join(',').toLowerCase().includes(product);
                const actStart = toDate(a.startTime);
                const actEnd = toDate(a.endTime);
                const okStart = !start || actEnd >= start;
                const okEnd = !end || actStart <= end;
                return okName && okMerchant && okStatus && okProd && okStart && okEnd;
            });
            renderAdminActivityResults(rows);
            if (rows.length) selectAdminActivity(rows[0].id); else showModal('info','无匹配结果','系统显示没有符合条件的活动，请调整筛选条件。','ℹ');
        }

        function selectAdminActivity(id) {
            const all = adminMockData.activities || [];
            const a = all.find(x => x.id === id);
            document.getElementById('actDetailName').textContent = a ? a.name : '-';
            document.getElementById('actDetailMerchant').textContent = a ? a.merchantName : '-';
            document.getElementById('actDetailTime').textContent = a ? `${a.startTime} ~ ${a.endTime}` : '-';
            document.getElementById('actDetailStatus').textContent = a ? a.status : '-';
            document.getElementById('actDetailRules').textContent = a ? a.rules : '-';
            updateList('actDetailProducts', a ? a.productNames : []);
            const rows = document.querySelectorAll('#adminActivityQueryBody tr');
            rows.forEach(r => r.classList.toggle('selected', r.getAttribute('data-id') === id));
        }

        /* ======================= 顾客管理（封禁/解禁/查询/注销） ======================= */
        function renderCustomerRows(rows, tbodyId, action) {
            const tbody = document.getElementById(tbodyId);
            if (!tbody) return;
            if (!rows || !rows.length) {
                tbody.innerHTML = `<tr><td colspan="5" style="text-align:center;color:#888;">暂无数据</td></tr>`;
                return;
            }
            tbody.innerHTML = rows.map(u => `
                <tr data-id="${u.id}">
                    <td>${u.username}</td>
                    <td>${u.name}</td>
                    <td>${u.phone}</td>
                    <td>${u.status}</td>
                    <td class="action-buttons">${action==='ban' ? `<button class="btn btn-warning" onclick="banCustomer('${u.id}')">封禁</button>` : action==='unban' ? `<button class=\"btn btn-primary\" onclick=\"unbanCustomer('${u.id}')\">解禁</button>` : action==='deact' ? `<button class=\"btn btn-secondary\" onclick=\"deactivateCustomer('${u.id}')\">注销</button>` : `<button class=\"btn-edit\" onclick=\"selectCustomer('${u.id}')\">查看</button>`}</td>
                </tr>
            `).join('');
        }

        function searchCustomersBan() {
            const name = (document.getElementById('banFilterName')?.value || '').trim().toLowerCase();
            const phone = (document.getElementById('banFilterPhone')?.value || '').trim();
            const all = adminMockData.customers || [];
            const rows = all.filter(u => u.status === '正常' && (!name || `${u.username}${u.name}`.toLowerCase().includes(name)) && (!phone || (u.phone||'').includes(phone)));
            renderCustomerRows(rows, 'banCustomerBody', 'ban');
            showModal('success','查询完成','已展示符合条件的正常用户。','✓');
        }

        function banCustomer(id) {
            const all = adminMockData.customers || [];
            const u = all.find(x => x.id === id);
            if (!u) return;
            u.status = '已封禁';
            showModal('warning','封禁成功',`用户 ${u.username} (${u.name}) 已被封禁。`, '⚠');
            searchCustomersBan();
        }

        function searchCustomersUnban() {
            const name = (document.getElementById('unbanFilterName')?.value || '').trim().toLowerCase();
            const all = adminMockData.customers || [];
            const rows = all.filter(u => u.status === '已封禁' && (!name || `${u.username}${u.name}`.toLowerCase().includes(name)));
            renderCustomerRows(rows, 'unbanCustomerBody', 'unban');
            showModal('success','查询完成','已展示被封禁的顾客。','✓');
        }

        function unbanCustomer(id) {
            const all = adminMockData.customers || [];
            const u = all.find(x => x.id === id);
            if (!u) return;
            u.status = '正常';
            showModal('success','解禁成功',`用户 ${u.username} (${u.name}) 已恢复正常状态。`, '✓');
            searchCustomersUnban();
        }

        function searchCustomersQuery() {
            const phone = (document.getElementById('custQueryPhone')?.value || '').trim();
            const username = (document.getElementById('custQueryUsername')?.value || '').trim().toLowerCase();
            const name = (document.getElementById('custQueryName')?.value || '').trim().toLowerCase();
            const status = (document.getElementById('custQueryStatus')?.value || '').trim();
            const all = adminMockData.customers || [];
            const rows = all.filter(u => {
                const okPhone = !phone || (u.phone||'').includes(phone);
                const okUser = !username || (u.username||'').toLowerCase().includes(username);
                const okName = !name || (u.name||'').toLowerCase().includes(name);
                const okStatus = !status || u.status === status;
                return okPhone && okUser && okName && okStatus;
            });
            renderCustomerRows(rows, 'adminCustomerQueryBody', 'view');
            if (rows.length) selectCustomer(rows[0].id);
            showModal('success','查询完成','已展示符合条件的顾客。','✓');
        }

        function selectCustomer(id) {
            const all = adminMockData.customers || [];
            const u = all.find(x => x.id === id);
            document.getElementById('custDetailUsername').textContent = u ? u.username : '-';
            document.getElementById('custDetailName').textContent = u ? u.name : '-';
            document.getElementById('custDetailPhone').textContent = u ? u.phone : '-';
            document.getElementById('custDetailStatus').textContent = u ? u.status : '-';
            const rows = document.querySelectorAll('#adminCustomerQueryBody tr');
            rows.forEach(r => r.classList.toggle('selected', r.getAttribute('data-id') === id));
        }

        function searchCustomersDeactivate() {
            const name = (document.getElementById('deactFilterName')?.value || '').trim().toLowerCase();
            const all = adminMockData.customers || [];
            const rows = all.filter(u => u.status !== '已注销' && (!name || `${u.username}${u.name}`.toLowerCase().includes(name)));
            renderCustomerRows(rows, 'deactCustomerBody', 'deact');
            showModal('success','查询完成','已展示可进行注销的顾客。','✓');
        }

        function deactivateCustomer(id) {
            const all = adminMockData.customers || [];
            const u = all.find(x => x.id === id);
            if (!u) return;
            u.status = '已注销';
            showModal('warning','注销成功',`用户 ${u.username} (${u.name}) 已注销。`, '⚠');
            searchCustomersDeactivate();
        }

        /* ======================= 服务商 暂停/恢复 ======================= */
        function renderProviderStatusRows(rows, tbodyId, action) {
            const tbody = document.getElementById(tbodyId);
            if (!tbody) return;
            if (!rows || !rows.length) { tbody.innerHTML = `<tr><td colspan="4" style="text-align:center;color:#888;">暂无数据</td></tr>`; return; }
            if (action === 'suspend') {
                tbody.innerHTML = rows.map(p => `
                    <tr data-id="${p.id}">
                        <td>${p.name}</td>
                        <td>${p.contactPhone || '-'}</td>
                        <td>${p.region || '-'}</td>
                        <td class="action-buttons"><button class="btn btn-warning" onclick="suspendProvider('${p.id}')">暂停</button></td>
                    </tr>
                `).join('');
            } else {
                tbody.innerHTML = rows.map(p => `
                    <tr data-id="${p.id}">
                        <td>${p.name}</td>
                        <td>${p.region || '-'}</td>
                        <td>${p.contactPhone || '-'}</td>
                        <td class="action-buttons"><button class="btn btn-primary" onclick="restoreProvider('${p.id}')">恢复</button></td>
                    </tr>
                `).join('');
            }
        }

        function searchProvidersSuspend() {
            const q = (document.getElementById('suspendProviderNameInput')?.value || '').trim().toLowerCase();
            const all = adminMockData.providerSearch || [];
            const rows = all.filter(p => (p.status === 'active') && (!q || (p.name||'').toLowerCase().includes(q)));
            renderProviderStatusRows(rows, 'providerSuspendBody', 'suspend');
            showModal('success','已显示在营服务商','可在列表中执行暂停操作。','✓');
        }

        function suspendProvider(id) {
            const all = adminMockData.providerSearch || [];
            const p = all.find(x => x.id === id);
            if (!p) return;
            p.status = 'suspended';
            showModal('warning','暂停成功',`服务商 ${p.name} 已被暂停，其所有服务被暂停，不能再接受服务订单。`, '⚠');
            searchProvidersSuspend();
        }

        function searchProvidersResume() {
            const q = (document.getElementById('resumeProviderNameInput')?.value || '').trim().toLowerCase();
            const all = adminMockData.providerSearch || [];
            const rows = all.filter(p => (p.status === 'suspended') && (!q || (p.name||'').toLowerCase().includes(q)));
            renderProviderStatusRows(rows, 'providerResumeBody', 'resume');
            showModal('success','已显示暂停中的服务商','可在列表中执行恢复操作。','✓');
        }

        function restoreProvider(id) {
            const all = adminMockData.providerSearch || [];
            const p = all.find(x => x.id === id);
            if (!p) return;
            p.status = 'active';
            showModal('success','恢复成功',`服务商 ${p.name} 的营业权限已恢复，其所有服务恢复销售。`, '✓');
            searchProvidersResume();
        }
    </script>
</body>
</html>
